<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  
  <title>悟者</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  
    <meta name="author" content="wuzer">
  
  
  <meta name="description" content="90后 摩羯座 码农">
<meta property="og:type" content="website">
<meta property="og:title" content="悟者">
<meta property="og:url" content="http://wuzer.me/page/2/index.html">
<meta property="og:site_name" content="悟者">
<meta property="og:description" content="90后 摩羯座 码农">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="悟者">
<meta name="twitter:description" content="90后 摩羯座 码农">
  
    <link rel="alternate" href="/atom.xml" title="悟者" type="application/atom+xml">
  
  
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>

<body>
  <div class="wrapper">
    <header id="header">
  <div class="title">
    <h1><a href="/">悟者</a></h1>
    <p><a href="/">就是玩票怎么滴</a></p>
  </div>
  <nav class="nav">
    <ul>
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/archives">Archives</a></li>
      
      
        <li><a href="/atom.xml">RSS</a></li>
      
    </ul>
    <div class="clearfix"></div>
  </nav>
  <div class="clearfix"></div>
</header>
    <div class="content">




  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/09/03/oauth-02-loadoauthpage/">
  <time datetime="2015-09-03T02:50:52.000Z">
    2015-09-03
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/09/03/oauth-02-loadoauthpage/"></a></h1>
  

  </header>
  
  <div class="entry">
    
      <h1 id="加载授权页面">加载授权页面</h1><h2 id="功能需求">功能需求</h2><ul>
<li>通过浏览器访问新浪授权页面，获取授权码</li>
</ul>
<h3 id="接口文档">接口文档</h3><p><a href="http://open.weibo.com/wiki/Oauth2/authorize" target="_blank" rel="external">http://open.weibo.com/wiki/Oauth2/authorize</a></p>
<ul>
<li>测试授权 URL</li>
</ul>
<p><a href="https://api.weibo.com/oauth2/authorize?client_id=479651210&amp;redirect_uri=http://itheima.com" target="_blank" rel="external">https://api.weibo.com/oauth2/authorize?client_id=479651210&amp;redirect_uri=http://itheima.com</a></p>
<blockquote>
<p>注意：回调地址必须与注册应用程序保持一致</p>
</blockquote>
<h2 id="功能实现">功能实现</h2><h3 id="准备工作">准备工作</h3><ul>
<li>新建 <code>OAuth</code> 文件夹</li>
<li>新建 <code>OAuthViewController.swift</code> 继承自 <code>UIViewController</code></li>
</ul>
<h4 id="加载_OAuth_视图控制器">加载 OAuth 视图控制器</h4><ul>
<li>修改 <code>BaseTableViewController</code> 中用户登录部分代码</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 用户登录</span></span><br><span class="line"><span class="preprocessor">@objc</span> private <span class="func"><span class="keyword">func</span> <span class="title">visitorLoginViewWillLogin</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> nav = <span class="type">UINavigationController</span>(rootViewController: <span class="type">OAuthViewController</span>())</span><br><span class="line"></span><br><span class="line">    presentViewController(nav, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>在 <code>OAuthViewController</code> 中添加以下代码</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">private <span class="keyword">var</span> webView = <span class="type">UIWebView</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="func"><span class="keyword">func</span> <span class="title">loadView</span><span class="params">()</span></span> &#123;</span><br><span class="line">    view = webView</span><br><span class="line"></span><br><span class="line">    title = <span class="string">"新浪微博"</span></span><br><span class="line">    navigationItem.leftBarButtonItem = <span class="type">UIBarButtonItem</span>(title: <span class="string">"关闭"</span>, style: <span class="type">UIBarButtonItemStyle</span>.<span class="type">Plain</span>, target: <span class="keyword">self</span>, action: <span class="string">"close"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// 关闭</span></span><br><span class="line"><span class="preprocessor">@objc</span> private <span class="func"><span class="keyword">func</span> <span class="title">close</span><span class="params">()</span></span> &#123;</span><br><span class="line">    dismissViewControllerAnimated(<span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>运行测试</p>
</blockquote>
<h3 id="加载授权页面-1">加载授权页面</h3><ul>
<li>在 <code>NetworkTools</code> 中定义应用程序授权相关信息</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - 应用程序信息</span></span><br><span class="line">private <span class="keyword">var</span> clientId = <span class="string">"3763573571"</span></span><br><span class="line">private <span class="keyword">var</span> appSecret = <span class="string">"d3e7a54be3676c0d067f252fa5d47c07"</span></span><br><span class="line">private <span class="keyword">var</span> redirectUri = <span class="string">"http://www.baidu.com"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/// 返回 OAuth 授权地址</span></span><br><span class="line"><span class="comment">/// * see: [http://open.weibo.com/wiki/Oauth2/authorize](http://open.weibo.com/wiki/Oauth2/authorize)</span></span><br><span class="line"><span class="keyword">var</span> authURL: <span class="type">NSURL</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> urlString = <span class="string">"https://api.weibo.com/oauth2/authorize?client_id=<span class="subst">\(clientId)</span>&amp;redirect_uri=<span class="subst">\(redirectUri)</span>"</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="type">NSURL</span>(string: urlString)!</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>在 <code>info.plist</code> 中增加 <code>ATS</code> 设置</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">key</span>&gt;</span>NSAppTransportSecurity<span class="tag">&lt;/<span class="title">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">dict</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">key</span>&gt;</span>NSAllowsArbitraryLoads<span class="tag">&lt;/<span class="title">key</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">true</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dict</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>加载授权页面</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="func"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line"></span><br><span class="line">    webView.loadRequest(<span class="type">NSURLRequest</span>(<span class="type">URL</span>: <span class="type">NetworkTools</span>.sharedTools.authURL))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="自动填充">自动填充</h3><ul>
<li>在 <code>loadView</code> 中添加<code>自动填充</code>按钮</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">navigationItem.rightBarButtonItem = <span class="type">UIBarButtonItem</span>(title: <span class="string">"自动填充"</span>, style: <span class="type">UIBarButtonItemStyle</span>.<span class="type">Plain</span>, target: <span class="keyword">self</span>, action: <span class="string">"autoFill"</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>实现自动填充代码</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 自动填充用户信息</span></span><br><span class="line"><span class="preprocessor">@objc</span> private <span class="func"><span class="keyword">func</span> <span class="title">autoFill</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> js = <span class="string">"document.getElementById('userId').value = 'daoge10000@sina.cn';"</span> +</span><br><span class="line">        <span class="string">"document.getElementById('passwd').value = 'qqq123';"</span></span><br><span class="line"></span><br><span class="line">    webView.stringByEvaluatingJavaScriptFromString(js)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>实现代理方法，跟踪重定向 URL</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - UIWebView 代理方法</span></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">webView</span><span class="params">(webView: UIWebView, shouldStartLoadWithRequest request: NSURLRequest, navigationType: UIWebViewNavigationType)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(request)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>结果分析</p>
<ul>
<li>如果 URL 以回调地址开始，需要检查查询参数</li>
<li>其他 URL 均加载</li>
</ul>
</li>
<li><p>修改代码</p>
</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">webView</span><span class="params">(webView: UIWebView, shouldStartLoadWithRequest request: NSURLRequest, navigationType: UIWebViewNavigationType)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> urlString = request.<span class="type">URL</span>!.absoluteString</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果 URL 不包含回调地址，继续加载</span></span><br><span class="line">    <span class="keyword">if</span> !urlString.hasPrefix(<span class="type">NetworkTools</span>.sharedTools.redirectUri) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 查询字符串</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> query = request.<span class="type">URL</span>?.query <span class="keyword">where</span> query.hasPrefix(<span class="string">"code="</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> code = query.substringFromIndex(<span class="string">"code="</span>.endIndex)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"请求码 <span class="subst">\(code)</span>"</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.close()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="加载指示器">加载指示器</h3><ul>
<li>导入 <code>SVProgressHUD</code></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="type">SVProgressHUD</span></span><br></pre></td></tr></table></figure>
<ul>
<li>WebView 代理方法</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">webViewDidStartLoad</span><span class="params">(webView: UIWebView)</span></span> &#123;</span><br><span class="line">    <span class="type">SVProgressHUD</span>.show()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">webViewDidFinishLoad</span><span class="params">(webView: UIWebView)</span></span> &#123;</span><br><span class="line">    <span class="type">SVProgressHUD</span>.dismiss()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>关闭</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">///  关闭</span></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">close</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="type">SVProgressHUD</span>.dismiss()</span><br><span class="line">    dismissViewControllerAnimated(<span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

    
  </div>
  <footer class="end-sep">
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/09/03/oauth-01-register/">
  <time datetime="2015-09-03T02:50:52.000Z">
    2015-09-03
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/09/03/oauth-01-register/"></a></h1>
  

  </header>
  
  <div class="entry">
    
      <h1 id="注册应用程序">注册应用程序</h1><h2 id="注册应用程序-1">注册应用程序</h2><ul>
<li>注册新浪微博账号</li>
<li>访问 <a href="http://open.weibo.com" target="_blank" rel="external">http://open.weibo.com</a></li>
<li>点击 <code>微连接</code> - <code>移动应用</code></li>
<li>填写基本信息，如下图所示：</li>
</ul>
<p><img src="./images/OAuth/注册应用程序.png" width="674" height="443"></p>
<ul>
<li>点击 <code>应用信息</code> - <code>高级信息</code>，设置回调地址，如下图所示：</li>
</ul>
<p><img src="./images/OAuth/授权回调地址.png" width="653" height="281"></p>
<h2 id="应用程序信息">应用程序信息</h2><table>
<thead>
<tr>
<th>Key</th>
<th>值</th>
</tr>
</thead>
<tbody>
<tr>
<td>client_id</td>
<td>113773579</td>
</tr>
<tr>
<td>client_secret</td>
<td>a34f52ecaad5571bfed41e6df78299f6</td>
</tr>
<tr>
<td>redirect_uri</td>
<td><a href="http://www.baidu.com" target="_blank" rel="external">http://www.baidu.com</a></td>
</tr>
<tr>
<td>access_token</td>
<td>2.00ml8IrF0jh4hHe09f471dc4C_L3nC</td>
</tr>
</tbody>
</table>
<blockquote>
<p>注意：授权回调地址一定要完全一致</p>
</blockquote>

    
  </div>
  <footer class="end-sep">
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/09/03/imagesassets/">
  <time datetime="2015-09-03T02:50:52.000Z">
    2015-09-03
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/09/03/imagesassets/"></a></h1>
  

  </header>
  
  <div class="entry">
    
      <h1 id="图片素材">图片素材</h1><h2 id="素材对应的设备">素材对应的设备</h2><table>
<thead>
<tr>
<th>1x</th>
<th>2x</th>
<th>3x</th>
</tr>
</thead>
<tbody>
<tr>
<td>大小对应开发中的<code>点</code></td>
<td>宽高是 <code>1x</code> 的两倍</td>
<td>宽高时 <code>1x</code> 的三倍</td>
</tr>
<tr>
<td>iPhone 3GS，可以省略</td>
<td>iPhone 4<br>iPhone 4s<br>iPhone 5<br>iPhone 5s<br>iPhone 6<br></td>
<td>iPhone 6+</td>
</tr>
</tbody>
</table>
<h2 id="与美工的配合">与美工的配合</h2><ul>
<li>让美工在设计原型图时，按照 <code>iPhone 6+</code> 的分辨率设计</li>
<li>然后切图的时候，切两套即可</li>
<li>一套以 @3x 结尾，供 iPhone 6+ 使用</li>
<li>一套缩小 2/3，以 @2x 结尾，供小屏视网膜手机使用</li>
</ul>
<blockquote>
<p>提示：现在大多数应用程序还适配 iOS 6，下载的 ipa 包能够拿到图片素材，但是如果今后应用程序只支持 iOS 7+，解压缩包之后，择无法再获得对应的图片素材。</p>
</blockquote>
<p><strong>请妥善保管好一些优秀作品的 IPA 文件</strong></p>

    
  </div>
  <footer class="end-sep">
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/09/03/imagesassets-01-icon_default/">
  <time datetime="2015-09-03T02:50:52.000Z">
    2015-09-03
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/09/03/imagesassets-01-icon_default/"></a></h1>
  

  </header>
  
  <div class="entry">
    
      <h1 id="图标素材_&amp;_App_名称">图标素材 &amp; App 名称</h1><h2 id="图标素材">图标素材</h2><h3 id="设置图标选项">设置图标选项</h3><ul>
<li>如下图所示，删除 <code>Launch Screen File</code> &amp; <code>Main.storyboard</code>，并且设置<code>启动图片</code>和<code>应用方向</code></li>
</ul>
<blockquote>
<p>提示：iPhone 项目一般不需要支持横屏，游戏除外</p>
</blockquote>
<p><img src="./images/Icons/icon&amp;default.png" alt=""></p>
<h3 id="添加图标">添加图标</h3><p><img src="./images/Icons/appicons.png" alt=""></p>
<h2 id="App_名称">App 名称</h2><p><img src="./images/Icons/applicationname.png" alt=""></p>
<ul>
<li>提示<ul>
<li>此处修改的内容是 <code>Info.plist</code> 中 <code>CFBundleName</code> 对应的内容</li>
<li>注意不要超过6个中文，否则会影响用户体验</li>
</ul>
</li>
</ul>
<h2 id="启动程序">启动程序</h2><ul>
<li>在 <code>AppDelegate</code> 的 <code>didFinishLaunchingWithOptions</code> 函数中添加以下代码：</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">window = <span class="type">UIWindow</span>(frame: <span class="type">UIScreen</span>.mainScreen().bounds)</span><br><span class="line">window?.backgroundColor = <span class="type">UIColor</span>.whiteColor()</span><br><span class="line">window?.rootViewController = <span class="type">ViewController</span>()</span><br><span class="line"></span><br><span class="line">window?.makeKeyAndVisible()</span><br></pre></td></tr></table></figure>
<blockquote>
<p>运行测试</p>
</blockquote>
<h3 id="添加启动图片">添加启动图片</h3><p><img src="./images/Icons/defaults.png" alt=""></p>
<ul>
<li>提示<ul>
<li>关于启动图片的设置，需要注意上课的操作细节</li>
<li>关于各个设备的实际屏幕尺寸，注意一下不同类型的启动图片即可</li>
</ul>
</li>
</ul>

    
  </div>
  <footer class="end-sep">
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/09/03/SUMMARY/">
  <time datetime="2015-09-03T02:50:52.000Z">
    2015-09-03
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/09/03/SUMMARY/"></a></h1>
  

  </header>
  
  <div class="entry">
    
      <h1 id="Summary">Summary</h1><ul>
<li><a href="README.md">新浪微博笔记</a><ul>
<li><a href="oschina.md">项目部署</a></li>
<li><a href="imagesassets.md">图片素材</a><ul>
<li><a href="imagesassets-01-icon_default.md">图标&amp;启动图片</a></li>
</ul>
</li>
<li><a href="createproject.md">项目搭建</a><ul>
<li><a href="createproject-01-createfiles.md">创建文件</a></li>
<li><a href="createproject-02-addchildcontrollers.md">添加子控制器</a></li>
<li><a href="createproject-03-costommaintabbar.md">自定义 TabBar</a></li>
<li><a href="createproject-04-summary.md">阶段性小结</a></li>
</ul>
</li>
<li><a href="visitor.md">未登录页面处理</a><ul>
<li><a href="visitor-01-basetableviewcontroller.md">表格视图控制器基类</a></li>
<li><a href="visitor-02-userloginview.md">用户登录视图</a></li>
<li><a href="visitor-03-loginlogic.md">设置未登录信息</a></li>
<li><a href="visitor-04-homeanimation.md">首页动画</a></li>
<li><a href="visitor-05-logindelegate.md">登录&amp;注册代理回调</a></li>
<li><a href="visitor-06-setupappearance.md">设置全局外观</a></li>
<li><a href="visitor-07-summary.md">阶段性小结</a></li>
</ul>
</li>
<li><a href="frameworks.md">第三方框架</a><ul>
<li><a href="frameworks-01-svprogresshud.md">OC 框架</a></li>
</ul>
</li>
<li><a href="oauth.md">OAuth</a><ul>
<li><a href="oauth-01-register.md">注册应用程序</a></li>
<li><a href="oauth-02-loadoauthpage.md">加载授权页面</a></li>
</ul>
</li>
<li><a href="accesstoken.md">AccessToken</a><ul>
<li><a href="accesstoken-01-init.md">UserAccount 模型</a></li>
<li><a href="accesstoken-02-didset.md">设置过期日期</a></li>
<li><a href="accesstoken-03-archive.md">归档 &amp; 解档</a></li>
<li><a href="accesstoken-04-view_model.md">视图模型</a></li>
<li><a href="accesstoken-04-loaduserinfo.md">加载用户信息</a></li>
</ul>
</li>
</ul>
</li>
</ul>

    
  </div>
  <footer class="end-sep">
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/09/03/visitor-07-summary/">
  <time datetime="2015-09-03T02:50:52.000Z">
    2015-09-03
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/09/03/visitor-07-summary/"></a></h1>
  

  </header>
  
  <div class="entry">
    
      <h1 id="阶段性小结">阶段性小结</h1><h2 id="应用程序设计">应用程序设计</h2><ul>
<li>程序开发过程中，如果因为需求变化要对应用程序做大幅度调整，以对现有代码做最小化修改为原则，可以考虑抽取基类的方式实现</li>
<li>整理项目目录结构时，不建议将 <code>AppDelegate</code> 隐藏</li>
</ul>
<h2 id="代理的使用">代理的使用</h2><ul>
<li>swift 中代理的使用基本与 OC 相同</li>
<li>需要注意的是，定义协议时，需要继承自 <code>NSObjectProtocol</code></li>
<li>代理属性需要使用 <code>weak</code> 防止出现循环引用</li>
</ul>
<h2 id="事件传递">事件传递</h2><ul>
<li>可以直接在控制器中添加<code>自定义视图</code>中的按钮监听方法</li>
<li>在 Swift 中可以直接将按钮开放</li>
<li>在 OC 中可以将按钮的定义放在 <code>.h</code> 中</li>
<li>在 Storyboard 中，可以直接拖线</li>
</ul>

    
  </div>
  <footer class="end-sep">
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/09/03/frameworks-01-svprogresshud/">
  <time datetime="2015-09-03T02:50:52.000Z">
    2015-09-03
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/09/03/frameworks-01-svprogresshud/"></a></h1>
  

  </header>
  
  <div class="entry">
    
      <h1 id="SDWebImage_&amp;_SVProgressHUD">SDWebImage &amp; SVProgressHUD</h1><h2 id="SVProgressHUD">SVProgressHUD</h2><ul>
<li><code>SVProgressHUD</code> 是使用 OC 开发的指示器</li>
<li>使用非常广泛</li>
</ul>
<h3 id="框架地址">框架地址</h3><p><a href="https://github.com/TransitApp/SVProgressHUD" target="_blank" rel="external">https://github.com/TransitApp/SVProgressHUD</a></p>
<h3 id="与_MBProgressHUD_对比">与 <code>MBProgressHUD</code> 对比</h3><ul>
<li><code>SVProgressHUD</code><ul>
<li>只支持 <code>ARC</code></li>
<li>支持较新的苹果 API</li>
<li>提供有素材包</li>
<li>使用更简单</li>
</ul>
</li>
<li><code>MBProgressHUD</code><ul>
<li>支持 <code>ARC</code> &amp; <code>MRC</code></li>
<li>没有素材包，程序员需要针对框架进行一定的定制才能使用</li>
</ul>
</li>
</ul>
<h3 id="使用">使用</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="type">SVProgressHUD</span></span><br><span class="line"></span><br><span class="line"><span class="type">SVProgressHUD</span>.showInfoWithStatus(<span class="string">"正在玩命加载中..."</span>, maskType: <span class="type">SVProgressHUDMaskType</span>.<span class="type">Gradient</span>)</span><br></pre></td></tr></table></figure>
<h2 id="SDWebImage">SDWebImage</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="type">SDWebImage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> url = <span class="type">NSURL</span>(string: <span class="string">"http://img0.bdstatic.com/img/image/6446027056db8afa73b23eaf953dadde1410240902.jpg"</span>)!</span><br><span class="line"><span class="type">SDWebImageManager</span>.sharedManager().downloadImageWithURL(url, options: <span class="type">SDWebImageOptions</span>.allZeros, progress: <span class="literal">nil</span>) &#123; (image, <span class="number">_</span>, <span class="number">_</span>, <span class="number">_</span>, <span class="number">_</span>) <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">let</span> data = <span class="type">UIImagePNGRepresentation</span>(image)</span><br><span class="line">    data.writeToFile(<span class="string">"/Users/liufan/Desktop/123.jpg"</span>, atomically: <span class="literal">true</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

    
  </div>
  <footer class="end-sep">
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/09/03/createproject/">
  <time datetime="2015-09-03T02:50:52.000Z">
    2015-09-03
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/09/03/createproject/"></a></h1>
  

  </header>
  
  <div class="entry">
    
      <h1 id="项目搭建">项目搭建</h1><h2 id="课程目标">课程目标</h2><ol>
<li>熟悉 swift 语法</li>
<li>搭建系统主体框架结构</li>
<li>对比与 OC 开发的异同</li>
<li>纯代码搭建框架</li>
</ol>

    
  </div>
  <footer class="end-sep">
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/09/03/createproject-04-summary/">
  <time datetime="2015-09-03T02:50:52.000Z">
    2015-09-03
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/09/03/createproject-04-summary/"></a></h1>
  

  </header>
  
  <div class="entry">
    
      <h1 id="阶段性小结">阶段性小结</h1><ul>
<li>整体开发思路与使用 OC 几乎一致</li>
<li>Swift 语法更加简洁</li>
<li>Swift 对类型校验更加严格，不同类型的变量不允许直接计算</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> w = tabBar.bounds.width / <span class="type">CGFloat</span>(childViewControllers.<span class="built_in">count</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>Swift 中的懒加载本质上是一个闭包，因此引用当前控制器的对象时需要使用 self.</p>
</li>
<li><p>不希望暴露的方法，应该使用 <code>private</code> 修饰符</p>
</li>
<li>按钮点击事件的调用是由 <code>运行循环</code> 监听并且以<code>消息机制</code>传递的，因此，按钮监听函数不能设置为 <code>private</code></li>
</ul>
<p><img src="./images/TabBar/按钮点击事件.png" alt=""></p>
<ul>
<li><code>viewDidLoad</code> 函数中添加子控制器只会完成控制器的添加，而不会为 <code>tabBar</code> 创建 <code>tabBarButton</code></li>
</ul>

    
  </div>
  <footer class="end-sep">
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/09/03/createproject-03-costommaintabbar/">
  <time datetime="2015-09-03T02:50:52.000Z">
    2015-09-03
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/09/03/createproject-03-costommaintabbar/"></a></h1>
  

  </header>
  
  <div class="entry">
    
      <h1 id="自定义_TabBar">自定义 TabBar</h1><h2 id="功能需求">功能需求</h2><ul>
<li>在 4 个控制器切换按钮中间增加一个撰写按钮</li>
<li>点击撰写按钮能够弹出对话框撰写微博</li>
</ul>
<h3 id="需求分析">需求分析</h3><ul>
<li>自定义 TabBar</li>
<li>计算控制器按钮位置，在中间添加一个 <code>撰写</code> 按钮</li>
</ul>
<h3 id="思路">思路</h3><ul>
<li>加号按钮的大小与其他 <code>tabBarItem</code> 的大小是一致的</li>
<li>如果不考虑 modal 的方式，其所在位置应该同样有一个 <code>tabBarItem</code></li>
<li>建立一个空的视图控制器形成占位</li>
<li>然后在该位置添加一个按钮遮挡</li>
</ul>
<h3 id="代码实现">代码实现</h3><ul>
<li>添加空的视图控制器</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 添加所有子控制器</span></span><br><span class="line">private <span class="func"><span class="keyword">func</span> <span class="title">addChildViewControllers</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    addChildViewController(<span class="type">UIViewController</span>())</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意 UIViewController() 的位置</p>
</blockquote>
<ul>
<li>添加按钮</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - 懒加载控件</span></span><br><span class="line"><span class="comment">/// 撰写按钮</span></span><br><span class="line">lazy <span class="keyword">var</span> composedButton: <span class="type">UIButton</span> = &#123;</span><br><span class="line">    <span class="keyword">let</span> button = <span class="type">UIButton</span>()</span><br><span class="line"></span><br><span class="line">    button.setImage(<span class="type">UIImage</span>(named: <span class="string">"tabbar_compose_icon_add"</span>), forState: <span class="type">UIControlState</span>.<span class="type">Normal</span>)</span><br><span class="line">    button.setImage(<span class="type">UIImage</span>(named: <span class="string">"tabbar_compose_icon_add_highlighted"</span>), forState: <span class="type">UIControlState</span>.<span class="type">Highlighted</span>)</span><br><span class="line">    button.setBackgroundImage(<span class="type">UIImage</span>(named: <span class="string">"tabbar_compose_button"</span>), forState: <span class="type">UIControlState</span>.<span class="type">Normal</span>)</span><br><span class="line">    button.setBackgroundImage(<span class="type">UIImage</span>(named: <span class="string">"tabbar_compose_button_highlighted"</span>), forState: <span class="type">UIControlState</span>.<span class="type">Highlighted</span>)</span><br><span class="line"></span><br><span class="line">    button.addTarget(<span class="keyword">self</span>, action: <span class="string">"clickComposeButton"</span>, forControlEvents: <span class="type">UIControlEvents</span>.<span class="type">TouchUpInside</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">self</span>.tabBar.addSubview(button)</span><br><span class="line">    <span class="keyword">return</span> button</span><br><span class="line">&#125;()</span><br></pre></td></tr></table></figure>
<ul>
<li>设置按钮位置</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="func"><span class="keyword">func</span> <span class="title">viewWillAppear</span><span class="params">(animated: Bool)</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.viewWillAppear(animated)</span><br><span class="line"></span><br><span class="line">    setupComposedButton()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// 设置撰写按钮</span></span><br><span class="line">private <span class="func"><span class="keyword">func</span> <span class="title">setupComposedButton</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> w = view.bounds.width / <span class="type">CGFloat</span>(childViewControllers.<span class="built_in">count</span>)</span><br><span class="line">    <span class="keyword">let</span> rect = <span class="type">CGRect</span>(origin: <span class="type">CGPointZero</span>, size: <span class="type">CGSize</span>(width: w, height: tabBar.bounds.height))</span><br><span class="line"></span><br><span class="line">    composedButton.frame = <span class="type">CGRectOffset</span>(rect, <span class="number">2</span> * w, <span class="number">0</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>添加按钮监听方法</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">btn.addTarget(<span class="keyword">self</span>, action: <span class="string">"clickComposeButton"</span>, forControlEvents: <span class="type">UIControlEvents</span>.<span class="type">TouchUpInside</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>按钮监听方法</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 单击撰写微博按钮</span></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">clickComposeButton</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="keyword">__FUNCTION__</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：按钮的监听方法不能使用 <code>private</code></p>
</blockquote>

    
  </div>
  <footer class="end-sep">
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  

  <nav id="pagination">
  
    <a href="/" class="prev">上一页</a>
  
  
    <a href="/page/3/" class="next">下一页</a>
  
  <div class="clearfix"></div>
</nav>

</div>
  </div>
  <footer id="footer"><div class="copyright">
  
  &copy; 2015 <a href="/">wuzer</a>
  
</div>
<div class="theme-copyright">
  Theme by <a href="https://github.com/orderedlist" target="_blank">orderedlist</a>
   | 
  Redesign by <a href="http://heroicyang.com/" target="_blank">Heroic Yang</a>
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
<script src="/js/scale.fix.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
  (function($){
    $('.fancybox').fancybox();
  })(jQuery);
</script>

</body>
</html>