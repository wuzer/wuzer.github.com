<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta property="og:type" content="website">
<meta property="og:title" content="悟者">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="悟者">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="悟者">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.2',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>悟者</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">悟者</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">90后,摩羯座,iOS攻城师</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Startseite
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archiv
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/27/丧丧的/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wuzer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="悟者">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/27/丧丧的/" itemprop="url">丧丧的</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-09-27T11:38:08+08:00">
                2017-09-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/12/29/UIcollectoinviewCell选中状态颜色设置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wuzer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="悟者">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/12/29/UIcollectoinviewCell选中状态颜色设置/" itemprop="url">UIcollectoinviewCell选中状态颜色设置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-12-29T15:23:34+08:00">
                2015-12-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这两天有个朋友想写个日历的app，用的UICollectionView搭建界面，写的过程中，他是需要改变每个cell的选中状态颜色和非选中颜色，而且cell是支持多个同时选中，然后他遇到的问题是当改变当前cell颜色，点击另外一个的时候，上一个cell的颜色会被清除，当前会变成选中，就是多选失效了。<br>    当时朋友把代码发给我看，我的想法其实是和他一样的，在cell的didSelected方法里面获取当前选中cell，改变当前cell的状态.但是这个正确的想法却没有正确的执行，我想肯定有哪些地方没有设置，导致出了问题。虽然collectionView用了不少次，但是之前一直没有这个需求改过选中状态，我就想先看看别人是怎么改的。在stackOverFlow上面搜索了下“Highlight collection cell when selected”，发现有好多人已经问过这个问题，点开第一条进去看了下，里面的一个回答直接贴的代码</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">-(<span class="built_in">UICollectionViewCell</span> *)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView    cellForItemAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</div><div class="line">&#123;</div><div class="line"><span class="built_in">UICollectionViewCell</span> *cell = [collectionView dequeueReusableCellWithReuseIdentifier:<span class="string">@"cvCell"</span> forIndexPath:indexPath];</div><div class="line"></div><div class="line"><span class="keyword">if</span> (cell.selected) &#123;</div><div class="line"> cell.backgroundColor = [<span class="built_in">UIColor</span> blueColor]; <span class="comment">// highlight selection </span></div><div class="line">&#125;</div><div class="line"><span class="keyword">else</span></div><div class="line">&#123;</div><div class="line"> cell.backgroundColor = [<span class="built_in">UIColor</span> redColor]; <span class="comment">// Default color</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> cell;</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(<span class="keyword">void</span>)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView didSelectItemAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath  &#123;</div><div class="line"></div><div class="line"><span class="built_in">UICollectionViewCell</span> *datasetCell =[collectionView cellForItemAtIndexPath:indexPath];</div><div class="line">datasetCell.backgroundColor = [<span class="built_in">UIColor</span> blueColor]; <span class="comment">// highlight selection</span></div><div class="line">&#125;  </div><div class="line">-(<span class="keyword">void</span>)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView didDeselectItemAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</div><div class="line">&#123;</div><div class="line"><span class="built_in">UICollectionViewCell</span> *datasetCell =[collectionView cellForItemAtIndexPath:indexPath]; </div><div class="line">datasetCell.backgroundColor = [<span class="built_in">UIColor</span> redColor]; <span class="comment">// Default color</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>看了代码后，和我们思路是一样的，没有解决我们的问题。继续找，有个回复给了一个属性</p>
<blockquote>
<p>@property(nonatomic) BOOL allowsMultipleSelection</p>
</blockquote>
<p>看了文档，是这样解释的</p>
<blockquote>
<p>This property controls whether multiple items can be selected simultaneously. The default value of this property is NO.</p>
<p>When the value of this property is YES, tapping a cell adds it to the current selection (assuming the delegate permits the cell to be selected). Tapping the cell again removes it from the selection.</p>
</blockquote>
<p>这个属性是控制cell多选的，默认是NO，当设置为YES时才可以添加当前选中的cell在组中。<br>在控制器里面把这个属性设置为yes后就可以多选了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/10/16/非对称加密算法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wuzer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="悟者">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/10/16/非对称加密算法/" itemprop="url">非对称加密算法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-10-16T16:23:27+08:00">
                2015-10-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><ul>
<li>非对称加密算法需要两个密钥：<code>公开密钥（publickey）</code> 和 <code>私有密钥（privatekey）</code></li>
<li>公开密钥与私有密钥是一对，如果用公开密钥对数据进行加密，只有用对应的私有密钥才能解密；如果用私有密钥对数据进行加密，那么只有用对应的公开密钥才能解密</li>
</ul>
<h2 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h2><ul>
<li>算法强度复杂、安全性依赖于算法与密钥</li>
<li>加密解密速度慢</li>
</ul>
<h2 id="与对称加密算法的对比"><a href="#与对称加密算法的对比" class="headerlink" title="与对称加密算法的对比"></a>与对称加密算法的对比</h2><ul>
<li>对称加密只有一种密钥，并且是非公开的，如果要解密就得让对方知道密钥</li>
<li>非对称密钥体制有两种密钥，其中一个是公开的</li>
</ul>
<h2 id="RSA-算法原理"><a href="#RSA-算法原理" class="headerlink" title="RSA 算法原理"></a>RSA 算法原理</h2><ol>
<li>找出两个“很大”的质数：P &amp; Q<ul>
<li>N = P * Q</li>
<li>M = (P – 1) * (Q – 1)</li>
</ul>
</li>
<li>找出整数E，E与M互质，即除了1之外，没有其他公约数</li>
<li>找出整数D，使得 E<em>D 除以 M 余 1，即 (E </em> D) % M = 1</li>
<li>经过上述准备工作之后，可以得到：<ul>
<li>E是公钥，负责加密</li>
<li>D是私钥，负责解密</li>
<li>N负责公钥和私钥之间的联系</li>
</ul>
</li>
<li>加密算法，假定对X进行加密<ul>
<li>(X ^ E) % N = Y</li>
</ul>
</li>
<li>解密算法，根据费尔马小定义，可以使用以下公式完成解密<ul>
<li>(Y ^ D) % N = X</li>
</ul>
</li>
</ol>
<h2 id="代码演练"><a href="#代码演练" class="headerlink" title="代码演练"></a>代码演练</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">CryptorTools *tools = [[CryptorTools alloc] init];</div><div class="line"></div><div class="line"><span class="comment">// 1. 加载公钥</span></div><div class="line"><span class="built_in">NSString</span> *pubPath = [[<span class="built_in">NSBundle</span> mainBundle] pathForResource:<span class="string">@"rsacert.der"</span> ofType:<span class="literal">nil</span>];</div><div class="line">[tools loadPublicKeyWithFilePath:pubPath];</div><div class="line"></div><div class="line"><span class="comment">// 2. 使用公钥加密，加密内容最大长度 117</span></div><div class="line"><span class="built_in">NSString</span> *result = [tools RSAEncryptString:<span class="string">@"abcdefghijklmnopqrstuvwxyz1234567890abcdefghijklmnopqrstuvwxyz1234567890abcdefghijklmnopqrstuvwxyz1234567890abcdefghi"</span>];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"RSA 加密 %@"</span>, result);</div><div class="line"></div><div class="line"><span class="comment">// 3. 加载私钥，并指定导出 p12 时设置的密码</span></div><div class="line"><span class="built_in">NSString</span> *privatePath = [[<span class="built_in">NSBundle</span> mainBundle] pathForResource:<span class="string">@"p.p12"</span> ofType:<span class="literal">nil</span>];</div><div class="line">[tools loadPrivateKey:privatePath password:<span class="string">@"123"</span>];</div><div class="line"></div><div class="line"><span class="comment">// 4. 使用私钥解密</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"解密结果 %@"</span>, [tools RSADecryptString:result]);</div></pre></td></tr></table></figure>
<h3 id="iOS-相关函数"><a href="#iOS-相关函数" class="headerlink" title="iOS 相关函数"></a>iOS 相关函数</h3><table>
<thead>
<tr>
<th>函数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>SecKeyEncrypt</td>
<td>使用公钥对数据加密</td>
</tr>
<tr>
<td>SecKeyDecrypt</td>
<td>使用私钥对数据解密</td>
</tr>
<tr>
<td>SecKeyRawVerify</td>
<td>使用公钥对数字签名进行验证</td>
</tr>
<tr>
<td>SecKeyRawSign</td>
<td>使用私钥生成数字签名</td>
</tr>
</tbody>
</table>
<h2 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h2><p>由于 <code>RSA</code> 算法的加密解密速度要比对称算法的速度慢很多，在实际应用中，通常采取：</p>
<ul>
<li>数据本身的加密解密使用对称加密算法(AES)</li>
<li>用 <code>RSA</code> 算法加密并传输对称算法所需的密钥</li>
</ul>
<h2 id="OpenSSL-终端测试命令"><a href="#OpenSSL-终端测试命令" class="headerlink" title="OpenSSL 终端测试命令"></a>OpenSSL 终端测试命令</h2><h3 id="程序开发证书生成"><a href="#程序开发证书生成" class="headerlink" title="程序开发证书生成"></a>程序开发证书生成</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 生成私钥</span></div><div class="line">$ openssl genrsa -out private.pem 1024</div><div class="line"><span class="comment"># 创建证书请求</span></div><div class="line">$ openssl req -new -key private.pem -out rsacert.csr</div><div class="line"><span class="comment"># 生成证书并签名，有效期10年</span></div><div class="line">$ openssl x509 -req -days 3650 -<span class="keyword">in</span> rsacert.csr -signkey private.pem -out rsacert.crt</div><div class="line"><span class="comment"># 转换格式-将 PEM 格式文件转换成 DER 格式</span></div><div class="line">$ openssl x509 -outform der -<span class="keyword">in</span> rsacert.crt -out rsacert.der</div><div class="line"><span class="comment"># 导出P12文件</span></div><div class="line">$ openssl pkcs12 -<span class="built_in">export</span> -out p.p12 -inkey private.pem -<span class="keyword">in</span> rsacert.crt</div></pre></td></tr></table></figure>
<blockquote>
<p>在苹果开发中，不能直接使用 PEM 格式的证书</p>
</blockquote>
<ul>
<li><code>DER</code> 文件是 <code>CRT</code> 文件的 <code>BASE 64</code> 解码前的二进制数据文件</li>
<li><code>OpenSSL</code> 默认生成的都是 <code>PEM</code> 格式的证书（BASE64 编码后的文本文件）</li>
</ul>
<h3 id="数字签名"><a href="#数字签名" class="headerlink" title="数字签名"></a>数字签名</h3><ul>
<li>发送方<ul>
<li><code>报文</code> HASH 得到 <code>报文摘要</code></li>
<li><code>报文摘要</code> 用公钥加密(数字签名) + 报文</li>
<li>发送给接收方</li>
</ul>
</li>
<li>接收方<ul>
<li><code>报文</code> HASH 得到 <code>报文摘要</code></li>
<li><code>数字签名</code> 用私钥解密 判断是否与 <code>报文摘要</code> 相同</li>
</ul>
</li>
</ul>
<h3 id="OpenSSL-生成密钥演练"><a href="#OpenSSL-生成密钥演练" class="headerlink" title="OpenSSL 生成密钥演练"></a>OpenSSL 生成密钥演练</h3><h4 id="私钥-amp-公钥"><a href="#私钥-amp-公钥" class="headerlink" title="私钥 &amp; 公钥"></a>私钥 &amp; 公钥</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 生成强度是 512 的 RSA 私钥</span></div><div class="line">$ openssl genrsa -out private.pem 512</div><div class="line"><span class="comment"># 以明文输出私钥内容</span></div><div class="line">$ openssl rsa -<span class="keyword">in</span> private.pem -text -out private.txt</div><div class="line"><span class="comment"># 校验私钥文件</span></div><div class="line">$ openssl rsa -<span class="keyword">in</span> private.pem -check</div><div class="line"><span class="comment"># 从私钥中提取公钥</span></div><div class="line">$ openssl rsa -<span class="keyword">in</span> private.pem -out public.pem -outform PEM -pubout</div><div class="line"><span class="comment"># 以明文输出公钥内容</span></div><div class="line">$ openssl rsa -<span class="keyword">in</span> public.pem -out public.txt -pubin -pubout -text</div></pre></td></tr></table></figure>
<h4 id="加密-amp-解密"><a href="#加密-amp-解密" class="headerlink" title="加密 &amp; 解密"></a>加密 &amp; 解密</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 使用公钥加密小文件</span></div><div class="line">$ openssl rsautl -encrypt -pubin -inkey public.pem -<span class="keyword">in</span> msg.txt -out msg.bin</div><div class="line"><span class="comment"># 使用私钥解密小文件</span></div><div class="line">$ openssl rsautl -decrypt -inkey private.pem -<span class="keyword">in</span> msg.bin -out a.txt</div></pre></td></tr></table></figure>
<h4 id="格式转换"><a href="#格式转换" class="headerlink" title="格式转换"></a>格式转换</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 将私钥转换成 DER 格式</span></div><div class="line">$ openssl rsa -<span class="keyword">in</span> private.pem -out private.der -outform der</div><div class="line"><span class="comment"># 将公钥转换成 DER 格式</span></div><div class="line">$ openssl rsa -<span class="keyword">in</span> public.pem -out public.der -pubin -outform der</div></pre></td></tr></table></figure>
<h3 id="PKCS"><a href="#PKCS" class="headerlink" title="PKCS"></a>PKCS</h3><ul>
<li>Public-Key Cryptography Standards (PKCS)是由美国 RSA 数据安全公司及其合作伙伴制定的一组公钥密码学标准，其中包括证书申请、证书更新、证书作废表发布、扩展证书内容以及数字签名、数字信封的格式等方面的一系列相关协议</li>
</ul>
<h4 id="PKCS协议"><a href="#PKCS协议" class="headerlink" title="PKCS协议"></a>PKCS协议</h4><table>
<thead>
<tr>
<th>协议</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>PKCS#1</td>
<td>定义 RSA 公开密钥算法加密和签名机制，主要用于组织 PKCS#7 中所描述的数字签名和数字信封（专门用来加密/解密）</td>
</tr>
<tr>
<td>PKCS#8</td>
<td>描述私有密钥信息格式，该信息包括公开密钥算法的私有密钥以及可选的属性集等（JAVA使用）</td>
</tr>
<tr>
<td>PKCS#12</td>
<td>描述个人信息交换语法标准。描述了将用户公钥、私钥、证书和其他相关信息打包的语法（苹果使用）</td>
</tr>
</tbody>
</table>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/10/16/对称加密算法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wuzer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="悟者">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/10/16/对称加密算法/" itemprop="url">对称加密算法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-10-16T16:22:03+08:00">
                2015-10-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="对称加密算法"><a href="#对称加密算法" class="headerlink" title="对称加密算法"></a>对称加密算法</h1><blockquote>
<p>提示：加密内容属于高级程序员的话题！有些内容会很枯燥！注意掌握加密的思路和操作步骤即可！代码不要求会写，只要会用就行！</p>
</blockquote>
<ul>
<li>又称传统加密算法</li>
<li>加密和解密使用同一个<code>密钥</code></li>
</ul>
<h2 id="对称加密算法示例"><a href="#对称加密算法示例" class="headerlink" title="对称加密算法示例"></a>对称加密算法示例</h2><ul>
<li>密钥：X</li>
<li>加密算法：每个字符+X</li>
<li>明文：<code>Hello</code></li>
<li>密钥为 <code>1</code> 时加密结果：<code>Ifmmp</code></li>
<li>密钥为 <code>2</code> 时加密结果：<code>Jgnnq</code></li>
</ul>
<h2 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h2><ul>
<li>优点<ul>
<li>算法公开、计算量小、加密速度快、加密效率高</li>
</ul>
</li>
<li>缺点<ul>
<li>双方使用相同钥匙，安全性得不到保证</li>
</ul>
</li>
</ul>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ul>
<li>密钥的保密工作非常重要</li>
<li>密钥要求定期更换</li>
</ul>
<h2 id="经典算法"><a href="#经典算法" class="headerlink" title="经典算法"></a>经典算法</h2><table>
<thead>
<tr>
<th>算法</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>DES</td>
<td>数据加密标准（用的少，因为强度不够）</td>
</tr>
<tr>
<td>3DES</td>
<td>使用3个密钥，对相同的数据执行三次加密，强度增强</td>
</tr>
<tr>
<td>AES</td>
<td>高级加密标准，目前美国国家安全局使用的<br>苹果的钥匙串访问采用的是 AES 加密</td>
</tr>
</tbody>
</table>
<h2 id="ECB-amp-CBC"><a href="#ECB-amp-CBC" class="headerlink" title="ECB &amp; CBC"></a>ECB &amp; CBC</h2><ul>
<li>ECB ：电子代码本，就是说每个块都是独立加密的</li>
<li>CBC ：密码块链，使用一个密钥和一个初始化向量 (IV)对数据执行加密转换</li>
</ul>
<h3 id="OpenSSL-终端测试命令"><a href="#OpenSSL-终端测试命令" class="headerlink" title="OpenSSL 终端测试命令"></a>OpenSSL 终端测试命令</h3><h4 id="ECB"><a href="#ECB" class="headerlink" title="ECB"></a>ECB</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 加密</span></div><div class="line">$ openssl enc -des-ecb -K 616263 -nosalt -<span class="keyword">in</span> msg1.txt -out msg1.bin</div><div class="line"><span class="comment"># 解密</span></div><div class="line">$ openssl enc -des-ecb -K 616263 -nosalt -<span class="keyword">in</span> msg1.bin -out msg1.txt -d</div><div class="line"><span class="comment"># 查看加密之后的二进制文件</span></div><div class="line">$ xxd msg1.bin</div></pre></td></tr></table></figure>
<h4 id="CBC"><a href="#CBC" class="headerlink" title="CBC"></a>CBC</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 加密</span></div><div class="line">$ openssl enc -des-cbc -K 616263 -iv 0000000000000000 -nosalt -<span class="keyword">in</span> a.txt -out msg1.bin</div><div class="line"><span class="comment"># 解密</span></div><div class="line">$ openssl enc -des-cbc -K 616263 -iv 0000000000000000 -nosalt -<span class="keyword">in</span> msg1.bin -out msg4.txt -d</div><div class="line"><span class="comment"># 查看加密之后的二进制文件</span></div><div class="line">$ xxd msg1.bin</div></pre></td></tr></table></figure>
<blockquote>
<p>CBC加密可以有效地保证密文的完整性，也就是说如果有一个块在传送时丢失了（或被敌人改变了），就会导致后面所有的块无法正常解密这个特性可以用来防范一些窃听技巧</p>
</blockquote>
<h2 id="代码演练"><a href="#代码演练" class="headerlink" title="代码演练"></a>代码演练</h2><ul>
<li>AES</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSString</span> *key = <span class="string">@"abc"</span>;</div><div class="line"><span class="comment">// ECB 加密&amp;解密</span></div><div class="line"><span class="built_in">NSString</span> *str1 = [CryptorTools AESEncryptString:<span class="string">@"hello"</span> keyString:key iv:<span class="literal">nil</span>];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"AES ECB 加密 %@"</span>, str1);</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"AES ECB 解密 %@"</span>, [CryptorTools AESDecryptString:str1 keyString:key iv:<span class="literal">nil</span>]);</div><div class="line"></div><div class="line"><span class="comment">// CBC 加密&amp;解密</span></div><div class="line">uint8_t iv[<span class="number">8</span>] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>&#125;;</div><div class="line"><span class="built_in">NSData</span> *ivData = [<span class="built_in">NSData</span> dataWithBytes:iv length:<span class="keyword">sizeof</span>(iv)];</div><div class="line"><span class="built_in">NSString</span> *str2 = [CryptorTools AESEncryptString:<span class="string">@"hello"</span> keyString:key iv:ivData];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"AES CBC 加密 %@"</span>, str2);</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"AES CBC 解密 %@"</span>, [CryptorTools AESDecryptString:str2 keyString:key iv:ivData]);</div></pre></td></tr></table></figure>
<ul>
<li>DES</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSString</span> *key = <span class="string">@"abc"</span>;</div><div class="line"><span class="comment">// ECB 加密&amp;解密</span></div><div class="line"><span class="built_in">NSString</span> *str1 = [CryptorTools DESEncryptString:<span class="string">@"hello"</span> keyString:key iv:<span class="literal">nil</span>];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"DES ECB 加密 %@"</span>, str1);</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"DES ECB 解密 %@"</span>, [CryptorTools DESDecryptString:str1 keyString:key iv:<span class="literal">nil</span>]);</div><div class="line"></div><div class="line"><span class="comment">// CBC 加密&amp;解密</span></div><div class="line">uint8_t iv[<span class="number">8</span>] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>&#125;;</div><div class="line"><span class="built_in">NSData</span> *ivData = [<span class="built_in">NSData</span> dataWithBytes:iv length:<span class="keyword">sizeof</span>(iv)];</div><div class="line"><span class="built_in">NSString</span> *str2 = [CryptorTools DESEncryptString:<span class="string">@"hello"</span> keyString:key iv:ivData];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"DES CBC 加密 %@"</span>, str2);</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"DES CBC 解密 %@"</span>, [CryptorTools DESDecryptString:str2 keyString:key iv:ivData]);</div></pre></td></tr></table></figure>
<h2 id="OpenSSL-终端测试命令-1"><a href="#OpenSSL-终端测试命令-1" class="headerlink" title="OpenSSL 终端测试命令"></a>OpenSSL 终端测试命令</h2><h3 id="ECB-加密-解密"><a href="#ECB-加密-解密" class="headerlink" title="ECB 加密/解密"></a>ECB 加密/解密</h3><ul>
<li>AES</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># AES(ECB)加密</span></div><div class="line">$ <span class="built_in">echo</span> -n <span class="string">"hello"</span> | openssl enc -aes-128-ecb -K 616263 -nosalt | base64</div><div class="line"></div><div class="line"><span class="comment"># AES(ECB)解密</span></div><div class="line">$ <span class="built_in">echo</span> -n <span class="string">"d1QG4T2tivoi0Kiu3NEmZQ=="</span> | base64 -D | openssl enc -aes-128-ecb -K 616263 -nosalt -d</div></pre></td></tr></table></figure>
<ul>
<li>DES</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># DES(ECB)加密</span></div><div class="line">$ <span class="built_in">echo</span> -n <span class="string">"hello"</span> | openssl enc -des-ecb -K 616263 -nosalt | base64</div><div class="line"></div><div class="line"><span class="comment"># DES(ECB)解密</span></div><div class="line">$ <span class="built_in">echo</span> -n <span class="string">"HQr0Oij2kbo="</span> | base64 -D | openssl enc -des-ecb -K 616263 -nosalt -d</div></pre></td></tr></table></figure>
<h3 id="CBC-加密-解密"><a href="#CBC-加密-解密" class="headerlink" title="CBC 加密/解密"></a>CBC 加密/解密</h3><ul>
<li>AES</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># AES(CBC)加密</span></div><div class="line">$ <span class="built_in">echo</span> -n <span class="string">"hello"</span> | openssl enc -aes-128-cbc -iv 0102030405060708 -K 616263 -nosalt | base64</div><div class="line"></div><div class="line">AES(CBC)解密</div><div class="line">$ <span class="built_in">echo</span> -n <span class="string">"u3W/N816uzFpcg6pZ+kbdg=="</span> | base64 -D | openssl enc -aes-128-cbc -iv 0102030405060708 -K 616263 -nosalt -d</div></pre></td></tr></table></figure>
<ul>
<li>DES</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># DES(CBC)加密</span></div><div class="line">$ <span class="built_in">echo</span> -n <span class="string">"hello"</span> | openssl enc -des-cbc -K 616263 -nosalt -iv 0102030405060708 | base64</div><div class="line"></div><div class="line"><span class="comment"># DES(CBC)解密</span></div><div class="line">$ <span class="built_in">echo</span> -n <span class="string">"alvrvb3Gz88="</span> | base64 -D | openssl enc -des-cbc -K 616263 -nosalt -iv 0102030405060708 -d</div></pre></td></tr></table></figure>
<p>终端命令说明</p>
<ul>
<li>加密过程是先加密，再base64编码</li>
<li>解密过程是先base64解码，再解密</li>
<li><code>|</code> 是终端管道命令，会将前一个命令结果传递给后一个命令</li>
<li><code>-K</code> 使用的密钥需要是密钥的 ASCII 码</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/10/16/钥匙串/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wuzer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="悟者">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/10/16/钥匙串/" itemprop="url">钥匙串</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-10-16T16:21:17+08:00">
                2015-10-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="钥匙串"><a href="#钥匙串" class="headerlink" title="钥匙串"></a>钥匙串</h1><ul>
<li>苹果的”生态圈”，钥匙串访问，使用 AES 256 加密算法，能够保证用户密码的安全</li>
<li>钥匙串访问SDK，是苹果在 <code>iOS 7.0.3</code> 版本以后公布的</li>
<li>钥匙串访问的接口是纯 C 语言的，但是，网络上有一个哥们把它封装成 OC 的，使用相当简单！</li>
<li>钥匙串访问的密码保存在哪里？<ul>
<li>只有苹果知道！是为了进一步保障用户的密码安全！</li>
</ul>
</li>
<li>钥匙串访问的第三方框架，是对 C 框架的封装，可以不用看源代码</li>
</ul>
<h2 id="框架地址"><a href="#框架地址" class="headerlink" title="框架地址"></a>框架地址</h2><p><a href="https://github.com/soffes/sskeychain" target="_blank" rel="external">https://github.com/soffes/sskeychain</a></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/// 所有账户</span></div><div class="line">+ (<span class="built_in">NSArray</span> *)allAccounts;</div><div class="line"><span class="comment">/// 获取所有账户信息</span></div><div class="line">+ (<span class="built_in">NSArray</span> *)accountsForService:(<span class="built_in">NSString</span> *)serviceName;</div><div class="line"><span class="comment">/// 获取账号密码</span></div><div class="line">+ (<span class="built_in">NSString</span> *)passwordForService:(<span class="built_in">NSString</span> *)serviceName account:(<span class="built_in">NSString</span> *)account;</div><div class="line"><span class="comment">/// 删除账号密码</span></div><div class="line">+ (<span class="built_in">BOOL</span>)deletePasswordForService:(<span class="built_in">NSString</span> *)serviceName account:(<span class="built_in">NSString</span> *)account;</div><div class="line"><span class="comment">/// 将账号密码保存在钥匙串</span></div><div class="line">+ (<span class="built_in">BOOL</span>)setPassword:(<span class="built_in">NSString</span> *)password forService:(<span class="built_in">NSString</span> *)serviceName account:(<span class="built_in">NSString</span> *)account;</div></pre></td></tr></table></figure>
<h2 id="保存钥匙串"><a href="#保存钥匙串" class="headerlink" title="保存钥匙串"></a>保存钥匙串</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">///  保存用户信息</span></div><div class="line">- (<span class="keyword">void</span>)saveUserInfo &#123;</div><div class="line"></div><div class="line">    <span class="built_in">NSUserDefaults</span> *defaults = [<span class="built_in">NSUserDefaults</span> standardUserDefaults];</div><div class="line"></div><div class="line">    <span class="comment">// iOS 8.0 会直接写入沙盒，无需再使用 `[defaults synchronize];`</span></div><div class="line">    [defaults setObject:<span class="keyword">self</span>.username forKey:HMUsernameKey];</div><div class="line"></div><div class="line">    <span class="comment">// 将用户密码保存在钥匙串</span></div><div class="line">    <span class="built_in">NSString</span> *bundleId = [<span class="built_in">NSBundle</span> mainBundle].bundleIdentifier;</div><div class="line">    [SSKeychain setPassword:<span class="keyword">self</span>.pwd forService:bundleId account:<span class="keyword">self</span>.username];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="从钥匙串加载密码"><a href="#从钥匙串加载密码" class="headerlink" title="从钥匙串加载密码"></a>从钥匙串加载密码</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">///  加载用户下信息</span></div><div class="line">- (<span class="keyword">void</span>)loadUserInfo &#123;</div><div class="line">    <span class="built_in">NSUserDefaults</span> *defaults = [<span class="built_in">NSUserDefaults</span> standardUserDefaults];</div><div class="line"></div><div class="line">    <span class="keyword">self</span>.usernameText.text = [defaults stringForKey:HMUsernameKey];</div><div class="line"></div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, [SSKeychain allAccounts]);</div><div class="line">    <span class="built_in">NSString</span> *bundleId = [<span class="built_in">NSBundle</span> mainBundle].bundleIdentifier;</div><div class="line">    <span class="keyword">self</span>.pwdText.text = [SSKeychain passwordForService:bundleId account:<span class="keyword">self</span>.usernameText.text];</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/10/16/MD5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wuzer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="悟者">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/10/16/MD5/" itemprop="url">MD5</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-10-16T16:20:34+08:00">
                2015-10-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="约定"><a href="#约定" class="headerlink" title="约定"></a>约定</h2><ul>
<li>同样的密码，同样的加密算法，每次加密的结果是不一样</li>
</ul>
<h2 id="密码方案"><a href="#密码方案" class="headerlink" title="密码方案"></a>密码方案</h2><ul>
<li>方案一：直接 MD5</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pwd = pwd.md5String;</div></pre></td></tr></table></figure>
<blockquote>
<p>非常不安全</p>
</blockquote>
<ul>
<li>方案二 MD5 + 盐</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pwd = [pwd stringByAppendingString:salt].md5String;</div></pre></td></tr></table></figure>
<blockquote>
<p>盐值要够<code>咸</code>，可以从服务器获取</p>
</blockquote>
<ul>
<li>安全方案三 - HMAC</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pwd = [pwd hmacMD5StringWithKey:<span class="string">@"itheima"</span>];</div></pre></td></tr></table></figure>
<blockquote>
<p>相对之前的方案，安全级别要高很多，使用 <code>itheima</code> 对 pwd 进行<code>加密</code>，然后在进行 md5，然后再次加密，再次 md5</p>
</blockquote>
<ul>
<li>安全方案四 - 时间戳密码</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">NSString</span> *)timePassword &#123;</div><div class="line">    <span class="comment">// 1. 生成key</span></div><div class="line">    <span class="built_in">NSString</span> *key = <span class="string">@"itheima"</span>.md5String;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"HMAC Key - %@"</span>, key);</div><div class="line"></div><div class="line">    <span class="comment">// 2. 对密码进行 hmac 加密</span></div><div class="line">    <span class="built_in">NSString</span> *pwd = [<span class="keyword">self</span>.pwd hmacMD5StringWithKey:key];</div><div class="line"></div><div class="line">    <span class="comment">// 3. 获取当前系统时间</span></div><div class="line">    <span class="built_in">NSDateFormatter</span> *fmt = [[<span class="built_in">NSDateFormatter</span> alloc] init];</div><div class="line">    fmt.locale = [<span class="built_in">NSLocale</span> localeWithLocaleIdentifier:<span class="string">@"zh"</span>];</div><div class="line">    fmt.dateFormat = <span class="string">@"yyyy-MM-dd HH:mm"</span>;</div><div class="line">    <span class="built_in">NSString</span> *dateStr = [fmt stringFromDate:[<span class="built_in">NSDate</span> date]];</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, dateStr);</div><div class="line"></div><div class="line">    <span class="comment">// 4. 将系统时间拼接在第一次加密密码的末尾</span></div><div class="line">    pwd = [pwd stringByAppendingString:dateStr];</div><div class="line"></div><div class="line">    <span class="comment">// 5. 返回拼接结果的再次 hmac</span></div><div class="line">    <span class="keyword">return</span> [pwd hmacMD5StringWithKey:key];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>密码时效大约两分钟，需要服务器脚本支持，安全级别高，不过客户端的时间与服务器的时间不同步</p>
</blockquote>
<ul>
<li>安全方案五 - 服务器时间戳密码</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/// 生成时间戳密码</span></div><div class="line">- (<span class="built_in">NSString</span> *)timePassword:(<span class="built_in">NSString</span> *)pwd &#123;</div><div class="line">    <span class="comment">// 1. 以 itheima.md5 作为 hmac key</span></div><div class="line">    <span class="built_in">NSString</span> *key = <span class="string">@"itheima"</span>.md5String;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"HMAC KEY - %@"</span>, key);</div><div class="line"></div><div class="line">    <span class="comment">// 2. 对密码进行 hamc</span></div><div class="line">    <span class="built_in">NSString</span> *pwd = [<span class="keyword">self</span>.pwd hmacMD5StringWithKey:key];</div><div class="line"></div><div class="line">    <span class="comment">// 3. 取服务器时间</span></div><div class="line">    <span class="built_in">NSData</span> *data = [<span class="built_in">NSData</span> dataWithContentsOfURL:[<span class="built_in">NSURL</span> URLWithString:<span class="string">@"http://localhost/hmackey.php"</span>]];</div><div class="line">    <span class="built_in">NSDictionary</span> *dict = [<span class="built_in">NSJSONSerialization</span> JSONObjectWithData:data options:<span class="number">0</span> error:<span class="literal">NULL</span>];</div><div class="line">    <span class="built_in">NSString</span> *dateStr = dict[<span class="string">@"key"</span>];</div><div class="line"></div><div class="line">    <span class="comment">// 4. 拼接时间字符串</span></div><div class="line">    pwd = [pwd stringByAppendingString:dateStr];</div><div class="line"></div><div class="line">    <span class="comment">// 5. 再次 hmac 散列密码</span></div><div class="line">    <span class="keyword">return</span> [pwd hmacMD5StringWithKey:key];</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/10/16/Base64/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wuzer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="悟者">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/10/16/Base64/" itemprop="url">Base64</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-10-16T16:19:45+08:00">
                2015-10-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>参考网站：<a href="http://zh.wikipedia.org/wiki/Base64" target="_blank" rel="external">http://zh.wikipedia.org/wiki/Base64</a></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><ul>
<li>是网络上使用最广泛的编码系统，能够将任何二进制数据，转换成只有 65 个字符组成的文本文件</li>
<li><code>a~z,A~Z,0~9,+,/,=</code></li>
<li><code>Base 64</code> 编码后的结果能够反算，不够安全</li>
<li><strong><code>Base 64</code> 是所有现代加密算法的基础算法</strong></li>
</ul>
<h2 id="终端命令"><a href="#终端命令" class="headerlink" title="终端命令"></a>终端命令</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 将 10.jpg 进行 base64 编码，生成 10.txt 文件</span></div><div class="line">$ base64 10.jpg -o 10.txt</div><div class="line"></div><div class="line"><span class="comment"># 将 10.txt 解码生成 1.jpg 文件</span></div><div class="line">$ base64 -D 10.txt -o 1.jpg</div><div class="line"></div><div class="line"><span class="comment"># 将字符串 Man 进行 base64 编码</span></div><div class="line">$ <span class="built_in">echo</span> -n <span class="string">"Man"</span> | base64</div><div class="line"></div><div class="line"><span class="comment"># 将字符串 TWFu 解码</span></div><div class="line">$ <span class="built_in">echo</span> -n <span class="string">"TWFu"</span> | base64 -D</div></pre></td></tr></table></figure>
<h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">///  BASE 64 编码</span></div><div class="line">- (<span class="built_in">NSString</span> *)base64Encode:(<span class="built_in">NSString</span> *)string &#123;</div><div class="line">    <span class="built_in">NSData</span> *data = [string dataUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</div><div class="line"></div><div class="line">    <span class="keyword">return</span> [data base64EncodedStringWithOptions:<span class="number">0</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">///  BASE 64 解码</span></div><div class="line">- (<span class="built_in">NSString</span> *)base64Decode:(<span class="built_in">NSString</span> *)string &#123;</div><div class="line">    <span class="built_in">NSData</span> *data = [[<span class="built_in">NSData</span> alloc] initWithBase64EncodedString:string options:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="keyword">return</span> [[<span class="built_in">NSString</span> alloc] initWithData:data encoding:<span class="built_in">NSUTF8StringEncoding</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="保存-amp-加载用户信息"><a href="#保存-amp-加载用户信息" class="headerlink" title="保存 &amp; 加载用户信息"></a>保存 &amp; 加载用户信息</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">///  保存用户信息</span></div><div class="line">- (<span class="keyword">void</span>)saveUserInfo &#123;</div><div class="line"></div><div class="line">    <span class="built_in">NSUserDefaults</span> *defaults = [<span class="built_in">NSUserDefaults</span> standardUserDefaults];</div><div class="line"></div><div class="line">    <span class="comment">// iOS 8.0 会直接写入沙盒，无需再使用 `[defaults synchronize];`</span></div><div class="line">    [defaults setObject:<span class="keyword">self</span>.username forKey:HMUsernameKey];</div><div class="line"></div><div class="line">    <span class="built_in">NSString</span> *pwd = [<span class="keyword">self</span> base64Encode:<span class="keyword">self</span>.pwd];</div><div class="line">    [defaults setObject:pwd forKey:HMUserPasswordKey];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">///  加载用户下信息</span></div><div class="line">- (<span class="keyword">void</span>)loadUserInfo &#123;</div><div class="line">    <span class="built_in">NSUserDefaults</span> *defaults = [<span class="built_in">NSUserDefaults</span> standardUserDefaults];</div><div class="line"></div><div class="line">    <span class="keyword">self</span>.usernameText.text = [defaults stringForKey:HMUsernameKey];</div><div class="line">    <span class="keyword">self</span>.pwdText.text = [<span class="keyword">self</span> base64Decode:[defaults stringForKey:HMUserPasswordKey]];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="存在的问题"><a href="#存在的问题" class="headerlink" title="存在的问题"></a>存在的问题</h2><ol>
<li>使用 <code>Base64</code> 不能直接看到用户密码的明文</li>
<li>但是 <code>Base64</code> 的算法是公开的，并且算法可逆，安全性并不好</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/10/16/密码学/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wuzer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="悟者">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/10/16/密码学/" itemprop="url">密码学</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-10-16T16:18:36+08:00">
                2015-10-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="历史"><a href="#历史" class="headerlink" title="历史"></a>历史</h2><ul>
<li>公元前-上世纪70年代：<code>传统密码学</code>(密码本)</li>
<li>上世纪70年代，<code>RSA</code> 算法的诞生开启了<code>现代密码学</code>的篇章</li>
</ul>
<h3 id="密码学趣闻"><a href="#密码学趣闻" class="headerlink" title="密码学趣闻"></a>密码学趣闻</h3><ul>
<li>跳舞的小人</li>
<li>中途岛海战</li>
</ul>
<blockquote>
<p>现代密码学 － 所有加密算法都是公开的！</p>
</blockquote>
<h2 id="散列-哈希-函数"><a href="#散列-哈希-函数" class="headerlink" title="散列(哈希)函数"></a>散列(哈希)函数</h2><ul>
<li><code>MD5</code>/<code>SHA1</code>/<code>SHA256</code>(美国国家安全局/苹果)/<code>SHA512</code></li>
<li>对任意一个二进制数据进行加密，可以得到定长的字符串结果</li>
<li><code>MD5</code> 加密结果是 <code>32</code> 个字符</li>
<li>核心思想是从给定的数据中，抽取特征码，不容易产生重复！加密后的字符串通常被称为 <code>指纹</code>，<code>信息摘要</code></li>
<li><code>MD5</code> 因为数据长度不够，现在国外基本上已经不怎么用了！国内用的很普遍</li>
<li><a href="http://baike.baidu.com/subview/350813/7544439.htm" target="_blank" rel="external">王小云</a></li>
<li>破解网站：<a href="http://www.cmd5.com" target="_blank" rel="external">http://www.cmd5.com</a></li>
</ul>
<h3 id="哈希函数的特点"><a href="#哈希函数的特点" class="headerlink" title="哈希函数的特点"></a>哈希函数的特点</h3><blockquote>
<p>相同的字符串，使用相同的算法，每次加密的结果是固定的</p>
</blockquote>
<h2 id="对称加密算法"><a href="#对称加密算法" class="headerlink" title="对称加密算法"></a>对称加密算法</h2><ul>
<li>加密和解密使用同一个秘钥，加密解密的速度快</li>
<li>可以给大数据进行加密</li>
<li>秘钥的安全性非常重要</li>
<li>使用 RSA 给对称加密算法的秘钥进行加密</li>
</ul>
<h2 id="非对称加密算法-RSA"><a href="#非对称加密算法-RSA" class="headerlink" title="非对称加密算法 RSA"></a>非对称加密算法 RSA</h2><ul>
<li>使用 <code>公钥</code> 加密，使用 <code>私钥</code> 解密</li>
<li>使用 <code>私钥</code> 加密，使用 <code>公钥</code> 解密</li>
<li>更安全</li>
<li>但是加密解密的速度极慢！</li>
<li>只是给小数据进行加密</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/10/16/核心动画/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wuzer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="悟者">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/10/16/核心动画/" itemprop="url">核心动画</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-10-16T16:11:47+08:00">
                2015-10-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> CAKeyframeAnimation    path/values</span></div><div class="line"><span class="comment"> CABasicAnimation       fromValue/toValue</span></div><div class="line"><span class="comment"> */</span></div><div class="line">- (<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event &#123;</div><div class="line">    <span class="comment">// 1. 位移动画</span></div><div class="line">    <span class="built_in">CAKeyframeAnimation</span> *anim1 = [<span class="built_in">CAKeyframeAnimation</span> animationWithKeyPath:<span class="string">@"position"</span>];</div><div class="line"></div><div class="line">    <span class="built_in">UIBezierPath</span> *path = [<span class="built_in">UIBezierPath</span> bezierPathWithOvalInRect:<span class="built_in">CGRectMake</span>(<span class="number">50</span>, <span class="number">50</span>, <span class="number">250</span>, <span class="number">250</span>)];</div><div class="line">    anim1.path = path.CGPath;</div><div class="line"></div><div class="line">    <span class="comment">// 2. 旋转动画</span></div><div class="line">    <span class="built_in">CABasicAnimation</span> *anim2 = [<span class="built_in">CABasicAnimation</span> animationWithKeyPath:<span class="string">@"transform.rotation"</span>];</div><div class="line">    anim2.toValue = @(<span class="number">2</span> * M_PI);</div><div class="line"></div><div class="line">    <span class="comment">// 3. 缩放动画</span></div><div class="line">    <span class="built_in">CAKeyframeAnimation</span> *anim3 = [<span class="built_in">CAKeyframeAnimation</span> animationWithKeyPath:<span class="string">@"transform.scale"</span>];</div><div class="line">    anim3.values = @[@<span class="number">1</span>, @<span class="number">0.1</span>, @<span class="number">1.2</span>];</div><div class="line"></div><div class="line">    <span class="built_in">CAAnimationGroup</span> *group = [[<span class="built_in">CAAnimationGroup</span> alloc] init];</div><div class="line">    group.animations = @[anim1, anim2, anim3];</div><div class="line">    group.duration = <span class="number">2.0</span>;</div><div class="line">    group.repeatCount = MAXFLOAT;</div><div class="line"></div><div class="line">    [<span class="keyword">self</span>.myView.layer addAnimation:group forKey:<span class="literal">nil</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/10/16/KVO/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wuzer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="悟者">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/10/16/KVO/" itemprop="url">KVO</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-10-16T16:08:37+08:00">
                2015-10-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><ul>
<li>KVO - key value observer <code>键值</code>观察</li>
<li><code>监听对象属性变化</code>的一种手段，可以用在开源框架，让代码解耦。例如：<code>上拉、下拉刷新控件</code></li>
</ul>
<h2 id="常见面试题"><a href="#常见面试题" class="headerlink" title="常见面试题"></a>常见面试题</h2><ul>
<li>KVO 是同步的还是异步的？</li>
</ul>
<h2 id="代码演练"><a href="#代码演练" class="headerlink" title="代码演练"></a>代码演练</h2><ul>
<li>添加观察</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 添加键值观察</span></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> 1. 调用对象：要监听的对象</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment"> 2. 参数</span></div><div class="line"><span class="comment"> 1&gt; 观察者，负责处理监听事件的对象</span></div><div class="line"><span class="comment"> 2&gt; 观察的属性</span></div><div class="line"><span class="comment"> 3&gt; 观察的选项</span></div><div class="line"><span class="comment"> 4&gt; 上下文</span></div><div class="line"><span class="comment"> */</span></div><div class="line">[<span class="keyword">self</span>.person addObserver:<span class="keyword">self</span> forKeyPath:<span class="string">@"name"</span> options:<span class="built_in">NSKeyValueObservingOptionNew</span> | <span class="built_in">NSKeyValueObservingOptionOld</span> context:<span class="string">@"Person Name"</span>];</div></pre></td></tr></table></figure>
<ul>
<li>监听方法</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// NSObject 分类方法，意味着所有的 NSObject 都可以实现这个方法！</span></div><div class="line"><span class="comment">// 跟协议的方法很像，分类方法又可以称为“隐式代理”！不提倡用，但是要知道概念！</span></div><div class="line"><span class="comment">// 所有的 kvo 监听到事件，都会调用此方法</span></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> 1. 观察的属性</span></div><div class="line"><span class="comment"> 2. 观察的对象</span></div><div class="line"><span class="comment"> 3. change 属性变化字典（新/旧）</span></div><div class="line"><span class="comment"> 4. 上下文，与监听的时候传递的一致</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment"> 可以利用上下文区分不同的监听！</span></div><div class="line"><span class="comment"> */</span></div><div class="line">- (<span class="keyword">void</span>)observeValueForKeyPath:(<span class="built_in">NSString</span> *)keyPath ofObject:(<span class="keyword">id</span>)object change:(<span class="built_in">NSDictionary</span> *)change context:(<span class="keyword">void</span> *)context &#123;</div><div class="line"></div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"睡会 %@"</span>, [<span class="built_in">NSThread</span> currentThread]);</div><div class="line"></div><div class="line">    [<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">1.0</span>];</div><div class="line"></div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@ %@ %@ %@"</span>, keyPath, object, change, context);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ul>
<li>监听方法执行会在属性变化所在的线程上执行！</li>
<li>如果多个线程同时修改一个属性，可能会出现资源抢夺的问题</li>
<li>如果监听的属性多，KVO 的监听方法会非常难写</li>
</ul>
<blockquote>
<p><strong>对象销毁之前，一定要取消监听</strong></p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          
            <p class="site-author-name" itemprop="name">wuzer</p>
            <p class="site-description motion-element" itemprop="description"></p>
        </div>

        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
            
              <a href="/archives/">
            
                <span class="site-state-item-count">15</span>
                <span class="site-state-item-name">Artikel</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">Tags</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">wuzer</span>

  
</div>


  <div class="powered-by">Erstellt mit  <a class="theme-link" href="https://hexo.io">Hexo</a></div>

  <span class="post-meta-divider">|</span>

  <div class="theme-info">Theme &mdash; <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.2</div>


        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>


  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  








  





  

  

  

  

  

  

</body>
</html>
