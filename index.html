<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>悟者</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="90后 摩羯座 码农">
<meta property="og:type" content="website">
<meta property="og:title" content="悟者">
<meta property="og:url" content="http://wuzer.me/index.html">
<meta property="og:site_name" content="悟者">
<meta property="og:description" content="90后 摩羯座 码农">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="悟者">
<meta name="twitter:description" content="90后 摩羯座 码农">
  
    <link rel="alternative" href="/atom.xml" title="悟者" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="null" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">wuzer</a></h1>
		</hgroup>

		
		<p class="header-subtitle">就是玩票怎么滴</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/第一篇">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="/#" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="/weibo.com/94217117" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="/#" title="rss">rss</a>
					        
								<a class="zhihu" target="_blank" href="/#" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">奥巴马的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">卡卡的美丽传说</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">唯有美食与你不可辜负</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">wuzer</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="null" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">wuzer</h1>
			</hgroup>
			
			<p class="header-subtitle">就是玩票怎么滴</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/第一篇">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="/#" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="/weibo.com/94217117" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="/#" title="rss">rss</a>
			        
						<a class="zhihu" target="_blank" href="/#" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-frameworks" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/09/03/frameworks/" class="article-date">
  	<time datetime="2015-09-03T02:50:52.000Z" itemprop="datePublished">2015-09-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="第三方框架">第三方框架</h1><h2 id="项目中使用到以下第三方框架">项目中使用到以下第三方框架</h2><ul>
<li><code>AFNetworking</code></li>
<li><code>SDWebImage</code></li>
<li><code>ReactiveCocoa</code></li>
<li><code>SVProgressHUD</code></li>
</ul>
<h2 id="Pod_安装">Pod 安装</h2><ul>
<li>git 备份</li>
<li>打开终端</li>
<li><code>$ cd</code> 进入项目目录</li>
<li>输入以下终端命令建立或编辑 <code>Podfile</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ touch Podfile</span><br></pre></td></tr></table></figure>
<ul>
<li>将 Podfile 拖入 Xcode 输入以下内容</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">use_frameworks</span>!</span><br><span class="line"><span class="rule"><span class="attribute">platform </span>:<span class="value">ios, <span class="string">'8.0'</span></span><br><span class="line">pod <span class="string">'AFNetworking'</span></span><br><span class="line">pod <span class="string">'SDWebImage'</span></span><br><span class="line">pod <span class="string">'ReactiveCocoa'</span></span><br><span class="line">pod <span class="string">'SVProgressHUD'</span></span></span></span><br></pre></td></tr></table></figure>
<ul>
<li>输入以下命令安装第三方框架</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pod install</span><br></pre></td></tr></table></figure>
<ul>
<li>如果第三方框架不能正常工作或者升级，可以输入以下命令更新</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pod update</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在 Swift 项目中，cocoapod 仅支持以 Framework 方式添加框架，因此需要在 Podfile 中添加 <code>use_frameworks!</code></p>
</blockquote>
<h2 id="修改项目版本">修改项目版本</h2><p><img src="./images/OAuth/修改项目版本.png" alt=""></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-visitor" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/09/03/visitor/" class="article-date">
  	<time datetime="2015-09-03T02:50:52.000Z" itemprop="datePublished">2015-09-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="未登录页面处理">未登录页面处理</h1><h2 id="课程目标">课程目标</h2><ol>
<li>自定义 <code>TableViewController</code> 的基类 <code>BaseTableViewController</code></li>
<li>自定义登录视图</li>
<li>统一导航栏按钮外观</li>
</ol>
<h2 id="应用实例">应用实例</h2><ul>
<li>在实际应用开发中，有可能会出现：<ul>
<li>功能框架已经构建完成</li>
<li>产品经理提出新的功能需求</li>
<li>而新提出的功能需求，会对已有的架构产生影响</li>
<li>例如，在新浪微博中，已经搭建好程序架构，但是如何应对用户登录的处理呢？</li>
</ul>
</li>
</ul>
<h2 id="新的需求_——_未登录页面">新的需求 —— 未登录页面</h2><h3 id="界面截图">界面截图</h3><ul>
<li>首页</li>
</ul>
<p><img src="./images/未登录界面截图/首页.png" width="320" height="568"></p>
<ul>
<li>消息</li>
</ul>
<p><img src="./images/未登录界面截图/消息.png" width="320" height="568"></p>
<ul>
<li>发现</li>
</ul>
<p><img src="./images/未登录界面截图/发现.png" width="320" height="568"></p>
<ul>
<li>我</li>
</ul>
<p><img src="./images/未登录界面截图/我.png" width="320" height="568"></p>
<h2 id="架构分析及调整">架构分析及调整</h2><ul>
<li>现有架构图</li>
</ul>
<p><img src="./images/未登录界面截图/现有架构图.png" width="603" height="243"></p>
<ul>
<li>新增 <code>BaseTableViewController</code></li>
</ul>
<p><img src="./images/未登录界面截图/新增BassTableVC.png" width="743" height="228"></p>
<ul>
<li><code>BaseTableViewController</code> 基本功能逻辑</li>
</ul>
<p><img src="./images/未登录界面截图/BaseTableVC功能逻辑.png" width="466" height="270"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-visitor-06-setupappearance" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/09/03/visitor-06-setupappearance/" class="article-date">
  	<time datetime="2015-09-03T02:50:52.000Z" itemprop="datePublished">2015-09-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="设置全局外观">设置全局外观</h1><ul>
<li>修改 AppDelegate 代码如下</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 设置全局外观</span></span><br><span class="line">private <span class="func"><span class="keyword">func</span> <span class="title">setupAppearance</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="type">UINavigationBar</span>.appearance().tintColor = <span class="type">UIColor</span>.orangeColor()</span><br><span class="line">    <span class="type">UITabBar</span>.appearance().tintColor = <span class="type">UIColor</span>.orangeColor()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="注意">注意</h2><ol>
<li>应用程序外观一经设置，全局有效，通常在 <code>AppDelegate</code> 中设置</li>
<li><code>AppDelegate</code> 是应用程序的入口，是快速阅读程序的入口，整理文件夹的时候不要把 <code>AppDelegate</code> 藏起来</li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-visitor-05-logindelegate" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/09/03/visitor-05-logindelegate/" class="article-date">
  	<time datetime="2015-09-03T02:50:52.000Z" itemprop="datePublished">2015-09-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="登录&amp;注册代理回调">登录&amp;注册代理回调</h1><ul>
<li>定义协议</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 访客登录视图协议</span></span><br><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">VisitorLoginViewDelegate</span> </span>&#123;</span><br><span class="line">    <span class="comment">/// 访客视图将要登录</span></span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">visitorLoginViewWillLogin</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">/// 访客视图将要注册</span></span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">visitorLoginViewWillRegister</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>定义协议时，需要继承自 <code>NSObjectProtocol</code>，否则无法设置代理的属性为 <code>weak</code></p>
</blockquote>
<ul>
<li>定义代理</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">weak</span> <span class="keyword">var</span> delegate: <span class="type">VisitorLoginViewDelegate</span>?</span><br></pre></td></tr></table></figure>
<ul>
<li>按钮回调</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - 按钮监听方法</span></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">clickLoginButton</span><span class="params">()</span></span> &#123;</span><br><span class="line">    delegte?.visitorLoginViewWillLogin()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">clickRegisterButton</span><span class="params">()</span></span> &#123;</span><br><span class="line">    delegte?.visitorLoginViewWillRegister()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>遵守协议</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BaseTableViewController</span>: <span class="title">UITableViewController</span>, <span class="title">VisitorLoginViewDelegate</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li>设置代理</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">visitorView?.delegte = <span class="keyword">self</span></span><br></pre></td></tr></table></figure>
<ul>
<li>实现方法</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - VisitorLoginViewDelegate</span></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">visitorLoginViewWillLogin</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"登录"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">visitorLoginViewWillRegister</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"注册"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>修改导航条按钮监听方法</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">navigationItem.leftBarButtonItem = <span class="type">UIBarButtonItem</span>(title: <span class="string">"注册"</span>, style: <span class="type">UIBarButtonItemStyle</span>.<span class="type">Plain</span>, target: <span class="keyword">self</span>, action: <span class="string">"visitorLoginViewWillRegister"</span>)</span><br><span class="line">navigationItem.rightBarButtonItem = <span class="type">UIBarButtonItem</span>(title: <span class="string">"登录"</span>, style: <span class="type">UIBarButtonItemStyle</span>.<span class="type">Plain</span>, target: <span class="keyword">self</span>, action: <span class="string">"visitorLoginViewWillLogin"</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>运行测试</p>
</blockquote>
<h1 id="登录&amp;注册按钮监听">登录&amp;注册按钮监听</h1><ul>
<li>修改 <code>BaseTableViewController</code><ul>
<li>删除遵守协议</li>
<li>删除设置代理属性</li>
</ul>
</li>
<li>修改 <code>VisitorLoginView</code><ul>
<li>删除协议</li>
<li>删除 <code>delegate</code> 属性</li>
<li>删除按钮监听方法</li>
<li>取消 <code>注册</code> &amp; <code>登录</code> 按钮的 <code>private</code> 修饰符</li>
</ul>
</li>
<li>在 <code>setupVisitorView</code> 方法中添加按钮监听方法</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置按钮监听方法</span></span><br><span class="line">visitorView?.registerButton.addTarget(<span class="keyword">self</span>, action: <span class="string">"visitorLoginViewWillRegistor"</span>, forControlEvents: <span class="type">UIControlEvents</span>.<span class="type">TouchUpInside</span>)</span><br><span class="line">visitorView?.loginButton.addTarget(<span class="keyword">self</span>, action: <span class="string">"visitorLoginViewWillLogin"</span>, forControlEvents: <span class="type">UIControlEvents</span>.<span class="type">TouchUpInside</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>修改按钮监听方法作用域</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - 按钮监听方法</span></span><br><span class="line"><span class="preprocessor">@objc</span> private <span class="func"><span class="keyword">func</span> <span class="title">visitorLoginViewWillLogin</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"登录"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="preprocessor">@objc</span> private <span class="func"><span class="keyword">func</span> <span class="title">visitorLoginViewWillRegistor</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"注册"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-visitor-04-homeanimation" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/09/03/visitor-04-homeanimation/" class="article-date">
  	<time datetime="2015-09-03T02:50:52.000Z" itemprop="datePublished">2015-09-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="首页动画">首页动画</h1><ul>
<li>添加动画代码</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 启动动画</span></span><br><span class="line">private <span class="func"><span class="keyword">func</span> <span class="title">startAnimation</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> anim = <span class="type">CABasicAnimation</span>(keyPath: <span class="string">"transform.rotation"</span>)</span><br><span class="line"></span><br><span class="line">    anim.toValue = <span class="number">2</span> * <span class="type">M_PI</span></span><br><span class="line">    anim.repeatCount = <span class="type">MAXFLOAT</span></span><br><span class="line">    anim.duration = <span class="number">20</span></span><br><span class="line"></span><br><span class="line">    iconView.layer.addAnimation(anim, forKey: <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>调整 <code>setupInfo</code> 函数</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 设置访客视图信息</span></span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="comment">/// - parameter imageName: 图片名称</span></span><br><span class="line"><span class="comment">/// - parameter message:   消息文字</span></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">setupInfo</span><span class="params">(imageName: String?, message: String)</span></span> &#123;</span><br><span class="line">    messageLabel.text = message</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> imageName = imageName &#123;</span><br><span class="line">        iconView.image = <span class="type">UIImage</span>(named: imageName)</span><br><span class="line">        homeIconView.hidden = <span class="literal">true</span></span><br><span class="line">        sendSubviewToBack(maskIconView)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        startAnimation()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>运行测试，发现切换控制器后动画会被释放，另外在首页退出到桌面再次进入，动画同样会被释放</p>
</blockquote>
<ul>
<li>设置动画属性</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">anim.removedOnCompletion = <span class="literal">false</span></span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-visitor-03-loginlogic" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/09/03/visitor-03-loginlogic/" class="article-date">
  	<time datetime="2015-09-03T02:50:52.000Z" itemprop="datePublished">2015-09-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="登录视图代码实现">登录视图代码实现</h1><ul>
<li>设置访客视图信息</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 设置访客视图信息</span></span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="comment">/// - parameter imageName: 图片名称</span></span><br><span class="line"><span class="comment">/// - parameter message:   消息文字</span></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">setupInfo</span><span class="params">(imageName: String?, message: String)</span></span> &#123;</span><br><span class="line">    messageLabel.text = message</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> imageName = imageName &#123;</span><br><span class="line">        iconView.image = <span class="type">UIImage</span>(named: imageName)</span><br><span class="line">        homeIconView.hidden = <span class="literal">true</span></span><br><span class="line">        sendSubviewToBack(maskIconView)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>在 <code>BaseTableViewController</code> 中添加登录视图属性</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 访客视图</span></span><br><span class="line"><span class="keyword">var</span> visitorView: <span class="type">VisitorLoginView</span>?</span><br></pre></td></tr></table></figure>
<ul>
<li>在 <code>setupVisitorView</code> 中记录登录视图</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">visitorView = <span class="type">VisitorLoginView</span>()</span><br><span class="line">view = visitorView</span><br></pre></td></tr></table></figure>
<h2 id="修改功能视图控制器中的代码">修改功能视图控制器中的代码</h2><ul>
<li>HomeTableViewController</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">visitorView?.setupInfo(<span class="literal">nil</span>, message: <span class="string">"关注一些人，回这里看看有什么惊喜"</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>MessageTableViewController</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">visitorView?.setupInfo(<span class="string">"visitordiscover_image_message"</span>, message: <span class="string">"登录后，别人评论你的微博，发给你的消息，都会在这里收到通知"</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>DiscoverTableViewController</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">visitorView?.setupInfo(<span class="string">"visitordiscover_image_message"</span>, message: <span class="string">"登录后，最新、最热微博尽在掌握，不再会与实事潮流擦肩而过"</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>ProfileTableViewController</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">visitorView?.setupInfo(<span class="string">"visitordiscover_image_profile"</span>, message: <span class="string">"登录后，你的微博、相册、个人资料会显示在这里，展示给别人"</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>提示信息<ul>
<li>关注一些人，回这里看看有什么惊喜</li>
<li>登录后，别人评论你的微博，发给你的消息，都会在这里收到通知</li>
<li>登录后，最新、最热微博尽在掌握，不再会与实事潮流擦肩而过</li>
<li>登录后，你的微博、相册、个人资料会显示在这里，展示给别人</li>
</ul>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-visitor-02-userloginview" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/09/03/visitor-02-userloginview/" class="article-date">
  	<time datetime="2015-09-03T02:50:52.000Z" itemprop="datePublished">2015-09-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="用户登录视图">用户登录视图</h1><blockquote>
<p>对于第三方开发者，新浪没有开放未登录访问数据的权限，因此在用户登录之前，无法 <code>加载微博数据</code> 以及 <code>关注用户</code></p>
</blockquote>
<h2 id="功能需求">功能需求</h2><ul>
<li>用户登录操作视图，用于在用户没有登录时替换表格控制器的根视图</li>
<li>每个功能模块的登录视图包含以下四个控件<ul>
<li>模块图标</li>
<li>描述文字</li>
<li>注册按钮</li>
<li>登录按钮</li>
</ul>
</li>
<li>特例<ul>
<li>首页有一个小的转轮图片会不停旋转</li>
</ul>
</li>
</ul>
<h2 id="功能实现">功能实现</h2><ul>
<li>拖拽相关图片素材</li>
<li>新建 <code>VisitorLoginView.swift</code> 继承自 <code>UIView</code></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 访客登录视图</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">VisitorLoginView</span>: <span class="title">UIView</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>(frame: <span class="type">CGRect</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(frame: frame)</span><br><span class="line"></span><br><span class="line">        setupUI()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    required <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(coder: aDecoder)</span><br><span class="line"></span><br><span class="line">        setupUI()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// 设置界面元素</span></span><br><span class="line">    private <span class="func"><span class="keyword">func</span> <span class="title">setupUI</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>修改 <code>setupVisitorView</code> 函数</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 替换根视图</span></span><br><span class="line">view = <span class="type">VisitorLoginView</span>()</span><br></pre></td></tr></table></figure>
<ul>
<li>添加界面元素</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 设置界面元素</span></span><br><span class="line">private <span class="func"><span class="keyword">func</span> <span class="title">setupUI</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// 1. 添加控件</span></span><br><span class="line">    addSubview(iconView)</span><br><span class="line">    addSubview(homeIconView)</span><br><span class="line">    addSubview(messageLabel)</span><br><span class="line">    addSubview(registerButton)</span><br><span class="line">    addSubview(loginButton)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// MARK: - 懒加载属性</span></span><br><span class="line"><span class="comment">/// 图标</span></span><br><span class="line">private lazy <span class="keyword">var</span> iconView: <span class="type">UIImageView</span> = <span class="type">UIImageView</span>(image: <span class="type">UIImage</span>(named: <span class="string">"visitordiscover_feed_image_smallicon"</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">/// 首页小房子图标</span></span><br><span class="line">private lazy <span class="keyword">var</span> homeIconView: <span class="type">UIImageView</span> = <span class="type">UIImageView</span>(image: <span class="type">UIImage</span>(named: <span class="string">"visitordiscover_feed_image_house"</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">/// 描述文字</span></span><br><span class="line">private lazy <span class="keyword">var</span> messageLabel: <span class="type">UILabel</span> = &#123;</span><br><span class="line">    <span class="keyword">let</span> label = <span class="type">UILabel</span>()</span><br><span class="line"></span><br><span class="line">    label.text = <span class="string">"关注一些人，回这里看看有什么惊喜"</span></span><br><span class="line">    label.sizeToFit()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> label</span><br><span class="line">&#125;()</span><br><span class="line"><span class="comment">/// 注册按钮</span></span><br><span class="line">private lazy <span class="keyword">var</span> registerButton: <span class="type">UIButton</span> = &#123;</span><br><span class="line">    <span class="keyword">let</span> btn = <span class="type">UIButton</span>()</span><br><span class="line"></span><br><span class="line">    btn.setBackgroundImage(<span class="type">UIImage</span>(named: <span class="string">"common_button_white_disable"</span>), forState: <span class="type">UIControlState</span>.<span class="type">Normal</span>)</span><br><span class="line">    btn.setTitle(<span class="string">"注册"</span>, forState: <span class="type">UIControlState</span>.<span class="type">Normal</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> btn</span><br><span class="line">&#125;()</span><br><span class="line"><span class="comment">/// 登录按钮</span></span><br><span class="line">private lazy <span class="keyword">var</span> loginButton: <span class="type">UIButton</span> = &#123;</span><br><span class="line">    <span class="keyword">let</span> btn = <span class="type">UIButton</span>()</span><br><span class="line"></span><br><span class="line">    btn.setBackgroundImage(<span class="type">UIImage</span>(named: <span class="string">"common_button_white_disable"</span>), forState: <span class="type">UIControlState</span>.<span class="type">Normal</span>)</span><br><span class="line">    btn.setTitle(<span class="string">"登录"</span>, forState: <span class="type">UIControlState</span>.<span class="type">Normal</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> btn</span><br><span class="line">&#125;()</span><br></pre></td></tr></table></figure>
<h3 id="设置自动布局">设置自动布局</h3><ul>
<li>设置图标约束 - 参照视图居中对齐</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1&gt; 图标</span></span><br><span class="line">iconView.translatesAutoresizingMaskIntoConstraints = <span class="literal">false</span></span><br><span class="line">addConstraint(<span class="type">NSLayoutConstraint</span>(item: iconView, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">CenterX</span>, relatedBy: <span class="type">NSLayoutRelation</span>.<span class="type">Equal</span>, toItem: <span class="keyword">self</span>, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">CenterX</span>, multiplier: <span class="number">1.0</span>, constant: <span class="number">0</span>))</span><br><span class="line">addConstraint(<span class="type">NSLayoutConstraint</span>(item: iconView, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">CenterY</span>, relatedBy: <span class="type">NSLayoutRelation</span>.<span class="type">Equal</span>, toItem: <span class="keyword">self</span>, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">CenterY</span>, multiplier: <span class="number">1.0</span>, constant: -<span class="number">60</span>))</span><br></pre></td></tr></table></figure>
<ul>
<li>设置首页小房子 - 参照图标居中对齐</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2&gt; 首页的房子</span></span><br><span class="line">homeIconView.translatesAutoresizingMaskIntoConstraints = <span class="literal">false</span></span><br><span class="line">addConstraint(<span class="type">NSLayoutConstraint</span>(item: homeIconView, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">CenterX</span>, relatedBy: <span class="type">NSLayoutRelation</span>.<span class="type">Equal</span>, toItem: iconView, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">CenterX</span>, multiplier: <span class="number">1.0</span>, constant: <span class="number">0</span>))</span><br><span class="line">addConstraint(<span class="type">NSLayoutConstraint</span>(item: homeIconView, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">CenterY</span>, relatedBy: <span class="type">NSLayoutRelation</span>.<span class="type">Equal</span>, toItem: iconView, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">CenterY</span>, multiplier: <span class="number">1.0</span>, constant: <span class="number">0</span>))</span><br></pre></td></tr></table></figure>
<ul>
<li>设置文本 - 参照图标，水平居中，下方 16 个点</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 3&gt; 描述文字</span></span><br><span class="line">messageLabel.translatesAutoresizingMaskIntoConstraints = <span class="literal">false</span></span><br><span class="line">addConstraint(<span class="type">NSLayoutConstraint</span>(item: messageLabel, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">CenterX</span>, relatedBy: <span class="type">NSLayoutRelation</span>.<span class="type">Equal</span>, toItem: iconView, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">CenterX</span>, multiplier: <span class="number">1.0</span>, constant: <span class="number">0</span>))</span><br><span class="line">addConstraint(<span class="type">NSLayoutConstraint</span>(item: messageLabel, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">Top</span>, relatedBy: <span class="type">NSLayoutRelation</span>.<span class="type">Equal</span>, toItem: iconView, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">Bottom</span>, multiplier: <span class="number">1.0</span>, constant: <span class="number">16</span>))</span><br></pre></td></tr></table></figure>
<ul>
<li>在懒加载函数中设置描述文字属性</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 描述文字</span></span><br><span class="line">private lazy <span class="keyword">var</span> messageLabel: <span class="type">UILabel</span> = &#123;</span><br><span class="line">    <span class="keyword">let</span> label = <span class="type">UILabel</span>()</span><br><span class="line"></span><br><span class="line">    label.font = <span class="type">UIFont</span>.systemFontOfSize(<span class="number">14</span>)</span><br><span class="line">    label.textColor = <span class="type">UIColor</span>.darkGrayColor()</span><br><span class="line">    label.text = <span class="string">"关注一些人，回这里看看有什么惊喜关注一些人，回这里看看有什么惊喜"</span></span><br><span class="line">    label.textAlignment = <span class="type">NSTextAlignment</span>.<span class="type">Center</span></span><br><span class="line">    label.numberOfLines = <span class="number">0</span></span><br><span class="line">    label.sizeToFit()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> label</span><br><span class="line">&#125;()</span><br></pre></td></tr></table></figure>
<ul>
<li>增加文本宽度约束 - 224</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">addConstraint(<span class="type">NSLayoutConstraint</span>(item: messageLabel, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">Width</span>, relatedBy: <span class="type">NSLayoutRelation</span>.<span class="type">Equal</span>, toItem: <span class="literal">nil</span>, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">NotAnAttribute</span>, multiplier: <span class="number">1.0</span>, constant: <span class="number">224</span>))</span><br></pre></td></tr></table></figure>
<ul>
<li>注册按钮，文本标签左下(16)对齐，宽度 100，高度 35</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 4&gt; 注册按钮</span></span><br><span class="line">registerButton.translatesAutoresizingMaskIntoConstraints = <span class="literal">false</span></span><br><span class="line">addConstraint(<span class="type">NSLayoutConstraint</span>(item: registerButton, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">Left</span>, relatedBy: <span class="type">NSLayoutRelation</span>.<span class="type">Equal</span>, toItem: messageLabel, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">Left</span>, multiplier: <span class="number">1.0</span>, constant: <span class="number">0</span>))</span><br><span class="line">addConstraint(<span class="type">NSLayoutConstraint</span>(item: registerButton, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">Top</span>, relatedBy: <span class="type">NSLayoutRelation</span>.<span class="type">Equal</span>, toItem: messageLabel, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">Bottom</span>, multiplier: <span class="number">1.0</span>, constant: <span class="number">16</span>))</span><br><span class="line">addConstraint(<span class="type">NSLayoutConstraint</span>(item: registerButton, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">Width</span>, relatedBy: <span class="type">NSLayoutRelation</span>.<span class="type">Equal</span>, toItem: <span class="literal">nil</span>, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">NotAnAttribute</span>, multiplier: <span class="number">1.0</span>, constant: <span class="number">100</span>))</span><br><span class="line">addConstraint(<span class="type">NSLayoutConstraint</span>(item: registerButton, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">Height</span>, relatedBy: <span class="type">NSLayoutRelation</span>.<span class="type">Equal</span>, toItem: <span class="literal">nil</span>, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">NotAnAttribute</span>, multiplier: <span class="number">1.0</span>, constant: <span class="number">35</span>))</span><br></pre></td></tr></table></figure>
<ul>
<li>调整按钮背景图片切片</li>
<li>设置注册按钮文字颜色</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">btn.setTitleColor(<span class="type">UIColor</span>.orangeColor(), forState: <span class="type">UIControlState</span>.<span class="type">Normal</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>登录按钮，文本标签右下(16)对齐，宽度 100，高度 35</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">loginButton.translatesAutoresizingMaskIntoConstraints = <span class="literal">false</span></span><br><span class="line">addConstraint(<span class="type">NSLayoutConstraint</span>(item: loginButton, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">Right</span>, relatedBy: <span class="type">NSLayoutRelation</span>.<span class="type">Equal</span>, toItem: messageLabel, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">Right</span>, multiplier: <span class="number">1.0</span>, constant: <span class="number">0</span>))</span><br><span class="line">addConstraint(<span class="type">NSLayoutConstraint</span>(item: loginButton, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">Top</span>, relatedBy: <span class="type">NSLayoutRelation</span>.<span class="type">Equal</span>, toItem: messageLabel, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">Bottom</span>, multiplier: <span class="number">1.0</span>, constant: <span class="number">16</span>))</span><br><span class="line">addConstraint(<span class="type">NSLayoutConstraint</span>(item: loginButton, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">Width</span>, relatedBy: <span class="type">NSLayoutRelation</span>.<span class="type">Equal</span>, toItem: <span class="literal">nil</span>, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">NotAnAttribute</span>, multiplier: <span class="number">1.0</span>, constant: <span class="number">100</span>))</span><br><span class="line">addConstraint(<span class="type">NSLayoutConstraint</span>(item: loginButton, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">Height</span>, relatedBy: <span class="type">NSLayoutRelation</span>.<span class="type">Equal</span>, toItem: <span class="literal">nil</span>, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">NotAnAttribute</span>, multiplier: <span class="number">1.0</span>, constant: <span class="number">35</span>))</span><br></pre></td></tr></table></figure>
<ul>
<li>设置登录按钮文字颜色</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">btn.setTitleColor(<span class="type">UIColor</span>.darkGrayColor(), forState: <span class="type">UIControlState</span>.<span class="type">Normal</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>调整控件整体垂直位置</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">addConstraint(<span class="type">NSLayoutConstraint</span>(item: iconView, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">CenterY</span>, relatedBy: <span class="type">NSLayoutRelation</span>.<span class="type">Equal</span>, toItem: <span class="keyword">self</span>, attribute: <span class="type">NSLayoutAttribute</span>.<span class="type">CenterY</span>, multiplier: <span class="number">1.0</span>, constant: -<span class="number">60</span>))</span><br></pre></td></tr></table></figure>
<ul>
<li>添加遮罩图片视图</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 遮罩视图</span></span><br><span class="line">private lazy <span class="keyword">var</span> maskIconView: <span class="type">UIImageView</span> = <span class="type">UIImageView</span>(image: <span class="type">UIImage</span>(named: <span class="string">"visitordiscover_feed_mask_smallicon"</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 添加控件</span></span><br><span class="line">addSubview(iconView)</span><br><span class="line">addSubview(maskIconView)</span><br><span class="line">addSubview(homeIconView)</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<ul>
<li>遮罩图片自动布局</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 6&gt; 遮罩视图</span></span><br><span class="line">maskIconView.translatesAutoresizingMaskIntoConstraints = <span class="literal">false</span></span><br><span class="line">addConstraints(<span class="type">NSLayoutConstraint</span>.constraintsWithVisualFormat(<span class="string">"H:|-0-[subview]-0-|"</span>, options: [], metrics: <span class="literal">nil</span>, views: [<span class="string">"subview"</span>: maskIconView]));</span><br><span class="line">addConstraints(<span class="type">NSLayoutConstraint</span>.constraintsWithVisualFormat(<span class="string">"V:|-0-[subview]-(-35)-[regButton]"</span>, options: [], metrics: <span class="literal">nil</span>, views: [<span class="string">"subview"</span>: maskIconView, <span class="string">"regButton"</span>: registerButton]));</span><br></pre></td></tr></table></figure>
<ul>
<li>视图背景颜色</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 3. 设置视图背景颜色</span></span><br><span class="line">backgroundColor = <span class="type">UIColor</span>(white: <span class="number">237.0</span> / <span class="number">255.0</span>, alpha: <span class="number">1.0</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>运行测试</p>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-visitor-01-basetableviewcontroller" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/09/03/visitor-01-basetableviewcontroller/" class="article-date">
  	<time datetime="2015-09-03T02:50:52.000Z" itemprop="datePublished">2015-09-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="表格视图控制器基类">表格视图控制器基类</h1><h2 id="功能需求">功能需求</h2><ul>
<li>判断用户是否登录，如果没有登录<ul>
<li>使用用户登录视图替换表格视图控制器的默认视图</li>
<li>在导航栏左侧添加 <code>注册</code> 按钮</li>
<li>在导航栏右侧添加 <code>登录</code> 按钮</li>
</ul>
</li>
</ul>
<h2 id="代码实现">代码实现</h2><ul>
<li>新建 <code>BaseTableViewController</code></li>
<li><p>将功能主界面的视图控制器基类设置为 <code>BaseTableViewController</code></p>
<ul>
<li>HomeTableViewController</li>
<li>MessageTableViewController</li>
<li>DiscoverTableViewController</li>
<li>ProfileTableViewController</li>
</ul>
</li>
<li><p>增加 用户登录标记，根据用户登录标记判断是否加载默认视图<br>*</p>
</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 功能模块控制器的基类控制器</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BaseTableViewController</span>: <span class="title">UITableViewController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// 用户登录标记</span></span><br><span class="line">    <span class="keyword">var</span> userLogon = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="func"><span class="keyword">func</span> <span class="title">loadView</span><span class="params">()</span></span> &#123;</span><br><span class="line">        userLogon ? <span class="keyword">super</span>.loadView() : setupVisitorView()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// 设置访客视图</span></span><br><span class="line">    private <span class="func"><span class="keyword">func</span> <span class="title">setupVisitorView</span><span class="params">()</span></span> &#123;</span><br><span class="line">        view = <span class="type">UIView</span>()</span><br><span class="line">        view.backgroundColor = <span class="type">UIColor</span>.orangeColor()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>修改 <code>userLogon</code> 的值，运行测试界面效果</p>
</blockquote>
<h3 id="添加导航栏按钮">添加导航栏按钮</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 设置访客视图</span></span><br><span class="line">private <span class="func"><span class="keyword">func</span> <span class="title">setupVisitorView</span><span class="params">()</span></span> &#123;</span><br><span class="line">    view = <span class="type">UIView</span>()</span><br><span class="line">    view.backgroundColor = <span class="type">UIColor</span>.orangeColor()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 添加导航栏按钮</span></span><br><span class="line">    navigationItem.leftBarButtonItem = <span class="type">UIBarButtonItem</span>(title: <span class="string">"注册"</span>, style: <span class="type">UIBarButtonItemStyle</span>.<span class="type">Plain</span>, target: <span class="literal">nil</span>, action: <span class="literal">nil</span>)</span><br><span class="line">    navigationItem.rightBarButtonItem = <span class="type">UIBarButtonItem</span>(title: <span class="string">"登录"</span>, style: <span class="type">UIBarButtonItemStyle</span>.<span class="type">Plain</span>, target: <span class="literal">nil</span>, action: <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-oschina" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/09/03/oschina/" class="article-date">
  	<time datetime="2015-09-03T02:50:52.000Z" itemprop="datePublished">2015-09-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="开源中国社区">开源中国社区</h1><h2 id="官方网站">官方网站</h2><p><a href="https://git.oschina.net/" target="_blank" rel="external">https://git.oschina.net/</a></p>
<ul>
<li>开源中国社区成立于2008年8月，其目的是为中国的IT技术人员提供一个全面的、快捷更新的用来检索开源软件以及交流使用开源经验的平台</li>
<li>目前国内有很多公司会将公司的项目部署在 <code>OSChina</code></li>
</ul>
<h3 id="与_GitHUB_的对比">与 <code>GitHUB</code> 的对比</h3><ol>
<li>服务器在国内，速度更快</li>
<li>免费账户同样可以建立 <code>私有</code> 项目，而 <code>GitHUB</code> 上要建立私有项目必须 <code>付费</code></li>
</ol>
<h3 id="使用">使用</h3><ul>
<li><p>注册账号</p>
<ul>
<li>建议使用网易的邮箱，使用其他免费邮箱可能会收不到验证邮件</li>
</ul>
</li>
<li><p>添加 SSH 公钥，进入终端，并输入以下命令</p>
<ul>
<li>开源中国帮助文档地址：<a href="https://git.oschina.net/oschina/git-osc/wikis/帮助#ssh-keys" target="_blank" rel="external">https://git.oschina.net/oschina/git-osc/wikis/帮助#ssh-keys</a></li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 切换目录，MAC中目录的第一个字符如果是 `.` 表示改文件夹是隐藏文件夹</span></span><br><span class="line">$ <span class="built_in">cd</span> ~/.ssh</span><br><span class="line"><span class="comment"># 查看当前目录文件</span></span><br><span class="line">$ ls</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成 RSA 密钥对</span></span><br><span class="line"><span class="comment"># 1&gt; "" 中输入个人邮箱</span></span><br><span class="line"><span class="comment"># 2&gt; 提示输入私钥文件名称，直接回车</span></span><br><span class="line"><span class="comment"># 3&gt; 提示输入密码，可以随便输入，只要本次能够记住即可</span></span><br><span class="line">$ ssh-keygen -t rsa -C <span class="string">"xxx@126.com"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看公钥内容</span></span><br><span class="line">$ cat id_rsa.pub</span><br></pre></td></tr></table></figure>
<ul>
<li><p>将公钥内容复制并粘贴至 <a href="https://git.oschina.net/profile/sshkeys" target="_blank" rel="external">https://git.oschina.net/profile/sshkeys</a></p>
</li>
<li><p>测试公钥</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 测试 SSH 连接</span></span><br><span class="line">$ ssh -T git@git.oschina.net</span><br><span class="line"></span><br><span class="line"><span class="comment"># 终端提示 `Welcome to Git@OSC, 刀哥!` 说明连接成功</span></span><br></pre></td></tr></table></figure>
<ul>
<li>新建项目</li>
<li>克隆项目</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 切换至项目目录</span></span><br><span class="line">$ <span class="built_in">cd</span> 项目目录</span><br><span class="line"></span><br><span class="line"><span class="comment"># 克隆项目，地址可以在项目首页复制</span></span><br><span class="line">$ git <span class="built_in">clone</span> git@git.oschina.net:xxx/ProjectName.git</span><br></pre></td></tr></table></figure>
<ul>
<li>添加 <code>gitignore</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ~/dev/github/gitignore/ 是保存 gitignore 的目录</span></span><br><span class="line">$ cp ~/dev/github/gitignore/Swift.gitignore .gitignore</span><br></pre></td></tr></table></figure>
<ul>
<li>提示：<ul>
<li>可以从 <code>https://github.com/github/gitignore</code> 获取最新版本的 <code>gitignore</code> 文件</li>
<li>添加 <code>.gitignore</code> 文件之后，每次提交时不会将个人的项目设置信息（例如：末次打开的文件，调试断点等）提交到服务器，在团队开发中非常重要</li>
</ul>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-oauth" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/09/03/oauth/" class="article-date">
  	<time datetime="2015-09-03T02:50:52.000Z" itemprop="datePublished">2015-09-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="OAuth">OAuth</h1><h2 id="基本概念">基本概念</h2><ul>
<li>OAuth 协议为用户资源的授权提供了一个安全的、开放而又简易的标准</li>
<li>OAuth 的授权不会使第三方触及到用户的帐号信息</li>
<li>OAuth 允许用户提供一个令牌，而不是用户名和密码来访问他们存放在特定服务提供者的数据</li>
<li>每一个令牌授权一个 <code>特定的网站</code> 在 <code>特定的时段内</code> 访问 <code>特定的资源</code></li>
</ul>
<h2 id="OAuth_授权流程图">OAuth 授权流程图</h2><p><img src="./images/OAuth/OAuth授权流程.png" width="568" height="541"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2015 wuzer
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>